LazyLoad=function(a){function b(b,c){var d,e=a.createElement(b);for(d in c)c.hasOwnProperty(d)&&e.setAttribute(d,c[d]);return e}function c(a){var b,c,d=j[a];d&&(b=d.callback,c=d.urls,c.shift(),k=0,c.length||(b&&b.call(d.context,d.obj),j[a]=null,l[a].length&&e(a)))}function d(){var b=navigator.userAgent;h={async:a.createElement("script").async===!0},(h.webkit=/AppleWebKit\//.test(b))||(h.ie=/MSIE|Trident/.test(b))||(h.opera=/Opera/.test(b))||(h.gecko=/Gecko\//.test(b))||(h.unknown=!0)}function e(e,k,m,n,o){var p,q,r,s,t,u,v=function(){c(e)},w="css"===e,x=[];if(h||d(),k)if(k="string"==typeof k?[k]:k.concat(),w||h.async||h.gecko||h.opera)l[e].push({urls:k,callback:m,obj:n,context:o});else for(p=0,q=k.length;q>p;++p)l[e].push({urls:[k[p]],callback:p===q-1?m:null,obj:n,context:o});if(!j[e]&&(s=j[e]=l[e].shift())){for(i||(i=a.head||a.getElementsByTagName("head")[0]),t=s.urls.concat(),p=0,q=t.length;q>p;++p)u=t[p],w?r=h.gecko?b("style"):b("link",{href:u,rel:"stylesheet"}):(r=b("script",{src:u}),r.async=!1),r.className="lazyload",r.setAttribute("charset","utf-8"),h.ie&&!w&&"onreadystatechange"in r&&!("draggable"in r)?r.onreadystatechange=function(){/loaded|complete/.test(r.readyState)&&(r.onreadystatechange=null,v())}:w&&(h.gecko||h.webkit)?h.webkit?(s.urls[p]=r.href,g()):(r.innerHTML='@import "'+u+'";',f(r)):r.onload=r.onerror=v,x.push(r);for(p=0,q=x.length;q>p;++p)i.appendChild(x[p])}}function f(a){var b;try{b=!!a.sheet.cssRules}catch(d){return k+=1,void(200>k?setTimeout(function(){f(a)},50):b&&c("css"))}c("css")}function g(){var a,b=j.css;if(b){for(a=m.length;--a>=0;)if(m[a].href===b.urls[0]){c("css");break}k+=1,b&&(200>k?setTimeout(g,50):c("css"))}}var h,i,j={},k=0,l={css:[],js:[]},m=a.styleSheets;return{css:function(a,b,c,d){e("css",a,b,c,d)},js:function(a,b,c,d){e("js",a,b,c,d)}}}(this.document),window.Modernizr=function(a,b,c){function d(a){o.cssText=a}function e(a,b){return typeof a===b}var f,g,h,i="2.7.1",j={},k=!0,l=b.documentElement,m="modernizr",n=b.createElement(m),o=n.style,p=({}.toString,{svg:"http://www.w3.org/2000/svg"}),q={},r=[],s=r.slice,t={}.hasOwnProperty;h=e(t,"undefined")||e(t.call,"undefined")?function(a,b){return b in a&&e(a.constructor.prototype[b],"undefined")}:function(a,b){return t.call(a,b)},Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;if("function"!=typeof b)throw new TypeError;var c=s.call(arguments,1),d=function(){if(this instanceof d){var e=function(){};e.prototype=b.prototype;var f=new e,g=b.apply(f,c.concat(s.call(arguments)));return Object(g)===g?g:f}return b.apply(a,c.concat(s.call(arguments)))};return d}),q.geolocation=function(){return"geolocation"in navigator},q.svg=function(){return!!b.createElementNS&&!!b.createElementNS(p.svg,"svg").createSVGRect},q.inlinesvg=function(){var a=b.createElement("div");return a.innerHTML="<svg/>",(a.firstChild&&a.firstChild.namespaceURI)==p.svg};for(var u in q)h(q,u)&&(g=u.toLowerCase(),j[g]=q[u](),r.push((j[g]?"":"no-")+g));return j.addTest=function(a,b){if("object"==typeof a)for(var d in a)h(a,d)&&j.addTest(d,a[d]);else{if(a=a.toLowerCase(),j[a]!==c)return j;b="function"==typeof b?b():b,"undefined"!=typeof k&&k&&(l.className+=" "+(b?"":"no-")+a),j[a]=b}return j},d(""),n=f=null,function(a,b){function c(a,b){var c=a.createElement("p"),d=a.getElementsByTagName("head")[0]||a.documentElement;return c.innerHTML="x<style>"+b+"</style>",d.insertBefore(c.lastChild,d.firstChild)}function d(){var a=s.elements;return"string"==typeof a?a.split(" "):a}function e(a){var b=r[a[p]];return b||(b={},q++,a[p]=q,r[q]=b),b}function f(a,c,d){if(c||(c=b),k)return c.createElement(a);d||(d=e(c));var f;return f=d.cache[a]?d.cache[a].cloneNode():o.test(a)?(d.cache[a]=d.createElem(a)).cloneNode():d.createElem(a),!f.canHaveChildren||n.test(a)||f.tagUrn?f:d.frag.appendChild(f)}function g(a,c){if(a||(a=b),k)return a.createDocumentFragment();c=c||e(a);for(var f=c.frag.cloneNode(),g=0,h=d(),i=h.length;i>g;g++)f.createElement(h[g]);return f}function h(a,b){b.cache||(b.cache={},b.createElem=a.createElement,b.createFrag=a.createDocumentFragment,b.frag=b.createFrag()),a.createElement=function(c){return s.shivMethods?f(c,a,b):b.createElem(c)},a.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+d().join().replace(/[\w\-]+/g,function(a){return b.createElem(a),b.frag.createElement(a),'c("'+a+'")'})+");return n}")(s,b.frag)}function i(a){a||(a=b);var d=e(a);return!s.shivCSS||j||d.hasCSS||(d.hasCSS=!!c(a,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),k||h(a,d),a}var j,k,l="3.7.0",m=a.html5||{},n=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,o=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,p="_html5shiv",q=0,r={};!function(){try{var a=b.createElement("a");a.innerHTML="<xyz></xyz>",j="hidden"in a,k=1==a.childNodes.length||function(){b.createElement("a");var a=b.createDocumentFragment();return"undefined"==typeof a.cloneNode||"undefined"==typeof a.createDocumentFragment||"undefined"==typeof a.createElement}()}catch(c){j=!0,k=!0}}();var s={elements:m.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:l,shivCSS:m.shivCSS!==!1,supportsUnknownElements:k,shivMethods:m.shivMethods!==!1,type:"default",shivDocument:i,createElement:f,createDocumentFragment:g};a.html5=s,i(b)}(this,b),j._version=i,l.className=l.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(k?" js "+r.join(" "):""),j}(this,this.document),function(a,b,c){function d(a){return"[object Function]"==q.call(a)}function e(a){return"string"==typeof a}function f(){}function g(a){return!a||"loaded"==a||"complete"==a||"uninitialized"==a}function h(){var a=r.shift();s=1,a?a.t?o(function(){("c"==a.t?m.injectCss:m.injectJs)(a.s,0,a.a,a.x,a.e,1)},0):(a(),h()):s=0}function i(a,c,d,e,f,i,j){function k(b){if(!n&&g(l.readyState)&&(t.r=n=1,!s&&h(),l.onload=l.onreadystatechange=null,b)){"img"!=a&&o(function(){v.removeChild(l)},50);for(var d in A[c])A[c].hasOwnProperty(d)&&A[c][d].onload()}}var j=j||m.errorTimeout,l=b.createElement(a),n=0,q=0,t={t:d,s:c,e:f,a:i,x:j};1===A[c]&&(q=1,A[c]=[]),"object"==a?l.data=c:(l.src=c,l.type=a),l.width=l.height="0",l.onerror=l.onload=l.onreadystatechange=function(){k.call(this,q)},r.splice(e,0,t),"img"!=a&&(q||2===A[c]?(v.insertBefore(l,u?null:p),o(k,j)):A[c].push(l))}function j(a,b,c,d,f){return s=0,b=b||"j",e(a)?i("c"==b?x:w,a,b,this.i++,c,d,f):(r.splice(this.i++,0,a),1==r.length&&h()),this}function k(){var a=m;return a.loader={load:j,i:0},a}var l,m,n=b.documentElement,o=a.setTimeout,p=b.getElementsByTagName("script")[0],q={}.toString,r=[],s=0,t="MozAppearance"in n.style,u=t&&!!b.createRange().compareNode,v=u?n:p.parentNode,n=a.opera&&"[object Opera]"==q.call(a.opera),n=!!b.attachEvent&&!n,w=t?"object":n?"script":"img",x=n?"script":w,y=Array.isArray||function(a){return"[object Array]"==q.call(a)},z=[],A={},B={timeout:function(a,b){return b.length&&(a.timeout=b[0]),a}};m=function(a){function b(a){var b,c,d,a=a.split("!"),e=z.length,f=a.pop(),g=a.length,f={url:f,origUrl:f,prefixes:a};for(c=0;g>c;c++)d=a[c].split("="),(b=B[d.shift()])&&(f=b(f,d));for(c=0;e>c;c++)f=z[c](f);return f}function g(a,e,f,g,h){var i=b(a),j=i.autoCallback;i.url.split(".").pop().split("?").shift(),i.bypass||(e&&(e=d(e)?e:e[a]||e[g]||e[a.split("/").pop().split("?")[0]]),i.instead?i.instead(a,e,f,g,h):(A[i.url]?i.noexec=!0:A[i.url]=1,f.load(i.url,i.forceCSS||!i.forceJS&&"css"==i.url.split(".").pop().split("?").shift()?"c":c,i.noexec,i.attrs,i.timeout),(d(e)||d(j))&&f.load(function(){k(),e&&e(i.origUrl,h,g),j&&j(i.origUrl,h,g),A[i.url]=2})))}function h(a,b){function c(a,c){if(a){if(e(a))c||(l=function(){var a=[].slice.call(arguments);m.apply(this,a),n()}),g(a,l,b,0,j);else if(Object(a)===a)for(i in h=function(){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c}(),a)a.hasOwnProperty(i)&&(!c&&!--h&&(d(l)?l=function(){var a=[].slice.call(arguments);m.apply(this,a),n()}:l[i]=function(a){return function(){var b=[].slice.call(arguments);a&&a.apply(this,b),n()}}(m[i])),g(a[i],l,b,i,j))}else!c&&n()}var h,i,j=!!a.test,k=a.load||a.both,l=a.callback||f,m=l,n=a.complete||f;c(j?a.yep:a.nope,!!k),k&&c(k)}var i,j,l=this.yepnope.loader;if(e(a))g(a,0,l,0);else if(y(a))for(i=0;i<a.length;i++)j=a[i],e(j)?g(j,0,l,0):y(j)?m(j):Object(j)===j&&h(j,l);else Object(a)===a&&h(a,l)},m.addPrefix=function(a,b){B[a]=b},m.addFilter=function(a){z.push(a)},m.errorTimeout=1e4,null==b.readyState&&b.addEventListener&&(b.readyState="loading",b.addEventListener("DOMContentLoaded",l=function(){b.removeEventListener("DOMContentLoaded",l,0),b.readyState="complete"},0)),a.yepnope=k(),a.yepnope.executeStack=h,a.yepnope.injectJs=function(a,c,d,e,i,j){var k,l,n=b.createElement("script"),e=e||m.errorTimeout;n.src=a;for(l in d)n.setAttribute(l,d[l]);c=j?h:c||f,n.onreadystatechange=n.onload=function(){!k&&g(n.readyState)&&(k=1,c(),n.onload=n.onreadystatechange=null)},o(function(){k||(k=1,c(1))},e),i?n.onload():p.parentNode.insertBefore(n,p)},a.yepnope.injectCss=function(a,c,d,e,g,i){var j,e=b.createElement("link"),c=i?h:c||f;e.href=a,e.rel="stylesheet",e.type="text/css";for(j in d)e.setAttribute(j,d[j]);g||(p.parentNode.insertBefore(e,p),o(c,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},function(a){function b(a,b,c){switch(arguments.length){case 2:return null!=a?a:b;case 3:return null!=a?a:null!=b?b:c;default:throw new Error("Implement me")}}function c(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function d(a,b){function c(){pb.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+a)}var d=!0;return j(function(){return d&&(c(),d=!1),b.apply(this,arguments)},b)}function e(a,b){return function(c){return m(a.call(this,c),b)}}function f(a,b){return function(c){return this.lang().ordinal(a.call(this,c),b)}}function g(){}function h(a){B(a),j(this,a)}function i(a){var b=u(a),c=b.year||0,d=b.quarter||0,e=b.month||0,f=b.week||0,g=b.day||0,h=b.hour||0,i=b.minute||0,j=b.second||0,k=b.millisecond||0;this._milliseconds=+k+1e3*j+6e4*i+36e5*h,this._days=+g+7*f,this._months=+e+3*d+12*c,this._data={},this._bubble()}function j(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return b.hasOwnProperty("toString")&&(a.toString=b.toString),b.hasOwnProperty("valueOf")&&(a.valueOf=b.valueOf),a}function k(a){var b,c={};for(b in a)a.hasOwnProperty(b)&&Db.hasOwnProperty(b)&&(c[b]=a[b]);return c}function l(a){return 0>a?Math.ceil(a):Math.floor(a)}function m(a,b,c){for(var d=""+Math.abs(a),e=a>=0;d.length<b;)d="0"+d;return(e?c?"+":"":"-")+d}function n(a,b){var c={milliseconds:0,months:0};return c.months=b.month()-a.month()+12*(b.year()-a.year()),a.clone().add(c.months,"M").isAfter(b)&&--c.months,c.milliseconds=+b-+a.clone().add(c.months,"M"),c}function o(a,b){var c;return b=E(b,a),a.isBefore(b)?c=n(a,b):(c=n(b,a),c.milliseconds=-c.milliseconds,c.months=-c.months),c}function p(a,b,c,d){var e=b._milliseconds,f=b._days,g=b._months;d=null==d?!0:d,e&&a._d.setTime(+a._d+e*c),f&&jb(a,"Date",ib(a,"Date")+f*c),g&&hb(a,ib(a,"Month")+g*c),d&&pb.updateOffset(a,f||g)}function q(a){return"[object Array]"===Object.prototype.toString.call(a)}function r(a){return"[object Date]"===Object.prototype.toString.call(a)||a instanceof Date}function s(a,b,c){var d,e=Math.min(a.length,b.length),f=Math.abs(a.length-b.length),g=0;for(d=0;e>d;d++)(c&&a[d]!==b[d]||!c&&w(a[d])!==w(b[d]))&&g++;return g+f}function t(a){if(a){var b=a.toLowerCase().replace(/(.)s$/,"$1");a=ec[a]||fc[b]||b}return a}function u(a){var b,c,d={};for(c in a)a.hasOwnProperty(c)&&(b=t(c),b&&(d[b]=a[c]));return d}function v(b){var c,d;if(0===b.indexOf("week"))c=7,d="day";else{if(0!==b.indexOf("month"))return;c=12,d="month"}pb[b]=function(e,f){var g,h,i=pb.fn._lang[b],j=[];if("number"==typeof e&&(f=e,e=a),h=function(a){var b=pb().utc().set(d,a);return i.call(pb.fn._lang,b,e||"")},null!=f)return h(f);for(g=0;c>g;g++)j.push(h(g));return j}}function w(a){var b=+a,c=0;return 0!==b&&isFinite(b)&&(c=b>=0?Math.floor(b):Math.ceil(b)),c}function x(a,b){return new Date(Date.UTC(a,b+1,0)).getUTCDate()}function y(a,b,c){return db(pb([a,11,31+b-c]),b,c).week}function z(a){return A(a)?366:365}function A(a){return a%4===0&&a%100!==0||a%400===0}function B(a){var b;a._a&&-2===a._pf.overflow&&(b=a._a[wb]<0||a._a[wb]>11?wb:a._a[xb]<1||a._a[xb]>x(a._a[vb],a._a[wb])?xb:a._a[yb]<0||a._a[yb]>23?yb:a._a[zb]<0||a._a[zb]>59?zb:a._a[Ab]<0||a._a[Ab]>59?Ab:a._a[Bb]<0||a._a[Bb]>999?Bb:-1,a._pf._overflowDayOfYear&&(vb>b||b>xb)&&(b=xb),a._pf.overflow=b)}function C(a){return null==a._isValid&&(a._isValid=!isNaN(a._d.getTime())&&a._pf.overflow<0&&!a._pf.empty&&!a._pf.invalidMonth&&!a._pf.nullInput&&!a._pf.invalidFormat&&!a._pf.userInvalidated,a._strict&&(a._isValid=a._isValid&&0===a._pf.charsLeftOver&&0===a._pf.unusedTokens.length)),a._isValid}function D(a){return a?a.toLowerCase().replace("_","-"):a}function E(a,b){return b._isUTC?pb(a).zone(b._offset||0):pb(a).local()}function F(a,b){return b.abbr=a,Cb[a]||(Cb[a]=new g),Cb[a].set(b),Cb[a]}function G(a){delete Cb[a]}function H(a){var b,c,d,e,f=0,g=function(a){if(!Cb[a]&&Eb)try{require("./lang/"+a)}catch(b){}return Cb[a]};if(!a)return pb.fn._lang;if(!q(a)){if(c=g(a))return c;a=[a]}for(;f<a.length;){for(e=D(a[f]).split("-"),b=e.length,d=D(a[f+1]),d=d?d.split("-"):null;b>0;){if(c=g(e.slice(0,b).join("-")))return c;if(d&&d.length>=b&&s(e,d,!0)>=b-1)break;b--}f++}return pb.fn._lang}function I(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function J(a){var b,c,d=a.match(Ib);for(b=0,c=d.length;c>b;b++)d[b]=kc[d[b]]?kc[d[b]]:I(d[b]);return function(e){var f="";for(b=0;c>b;b++)f+=d[b]instanceof Function?d[b].call(e,a):d[b];return f}}function K(a,b){return a.isValid()?(b=L(b,a.lang()),gc[b]||(gc[b]=J(b)),gc[b](a)):a.lang().invalidDate()}function L(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(Jb.lastIndex=0;d>=0&&Jb.test(a);)a=a.replace(Jb,c),Jb.lastIndex=0,d-=1;return a}function M(a,b){var c,d=b._strict;switch(a){case"Q":return Ub;case"DDDD":return Wb;case"YYYY":case"GGGG":case"gggg":return d?Xb:Mb;case"Y":case"G":case"g":return Zb;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return d?Yb:Nb;case"S":if(d)return Ub;case"SS":if(d)return Vb;case"SSS":if(d)return Wb;case"DDD":return Lb;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Pb;case"a":case"A":return H(b._l)._meridiemParse;case"X":return Sb;case"Z":case"ZZ":return Qb;case"T":return Rb;case"SSSS":return Ob;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return d?Vb:Kb;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return Kb;case"Do":return Tb;default:return c=new RegExp(V(U(a.replace("\\","")),"i"))}}function N(a){a=a||"";var b=a.match(Qb)||[],c=b[b.length-1]||[],d=(c+"").match(cc)||["-",0,0],e=+(60*d[1])+w(d[2]);return"+"===d[0]?-e:e}function O(a,b,c){var d,e=c._a;switch(a){case"Q":null!=b&&(e[wb]=3*(w(b)-1));break;case"M":case"MM":null!=b&&(e[wb]=w(b)-1);break;case"MMM":case"MMMM":d=H(c._l).monthsParse(b),null!=d?e[wb]=d:c._pf.invalidMonth=b;break;case"D":case"DD":null!=b&&(e[xb]=w(b));break;case"Do":null!=b&&(e[xb]=w(parseInt(b,10)));break;case"DDD":case"DDDD":null!=b&&(c._dayOfYear=w(b));break;case"YY":e[vb]=pb.parseTwoDigitYear(b);break;case"YYYY":case"YYYYY":case"YYYYYY":e[vb]=w(b);break;case"a":case"A":c._isPm=H(c._l).isPM(b);break;case"H":case"HH":case"h":case"hh":e[yb]=w(b);break;case"m":case"mm":e[zb]=w(b);break;case"s":case"ss":e[Ab]=w(b);break;case"S":case"SS":case"SSS":case"SSSS":e[Bb]=w(1e3*("0."+b));break;case"X":c._d=new Date(1e3*parseFloat(b));break;case"Z":case"ZZ":c._useUTC=!0,c._tzm=N(b);break;case"dd":case"ddd":case"dddd":d=H(c._l).weekdaysParse(b),null!=d?(c._w=c._w||{},c._w.d=d):c._pf.invalidWeekday=b;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":a=a.substr(0,1);case"gggg":case"GGGG":case"GGGGG":a=a.substr(0,2),b&&(c._w=c._w||{},c._w[a]=w(b));break;case"gg":case"GG":c._w=c._w||{},c._w[a]=pb.parseTwoDigitYear(b)}}function P(a){var c,d,e,f,g,h,i,j;c=a._w,null!=c.GG||null!=c.W||null!=c.E?(g=1,h=4,d=b(c.GG,a._a[vb],db(pb(),1,4).year),e=b(c.W,1),f=b(c.E,1)):(j=H(a._l),g=j._week.dow,h=j._week.doy,d=b(c.gg,a._a[vb],db(pb(),g,h).year),e=b(c.w,1),null!=c.d?(f=c.d,g>f&&++e):f=null!=c.e?c.e+g:g),i=eb(d,e,f,h,g),a._a[vb]=i.year,a._dayOfYear=i.dayOfYear}function Q(a){var c,d,e,f,g=[];if(!a._d){for(e=S(a),a._w&&null==a._a[xb]&&null==a._a[wb]&&P(a),a._dayOfYear&&(f=b(a._a[vb],e[vb]),a._dayOfYear>z(f)&&(a._pf._overflowDayOfYear=!0),d=_(f,0,a._dayOfYear),a._a[wb]=d.getUTCMonth(),a._a[xb]=d.getUTCDate()),c=0;3>c&&null==a._a[c];++c)a._a[c]=g[c]=e[c];for(;7>c;c++)a._a[c]=g[c]=null==a._a[c]?2===c?1:0:a._a[c];a._d=(a._useUTC?_:$).apply(null,g),null!=a._tzm&&a._d.setUTCMinutes(a._d.getUTCMinutes()+a._tzm)}}function R(a){var b;a._d||(b=u(a._i),a._a=[b.year,b.month,b.day,b.hour,b.minute,b.second,b.millisecond],Q(a))}function S(a){var b=new Date;return a._useUTC?[b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate()]:[b.getFullYear(),b.getMonth(),b.getDate()]}function T(a){if(a._f===pb.ISO_8601)return void X(a);a._a=[],a._pf.empty=!0;var b,c,d,e,f,g=H(a._l),h=""+a._i,i=h.length,j=0;for(d=L(a._f,g).match(Ib)||[],b=0;b<d.length;b++)e=d[b],c=(h.match(M(e,a))||[])[0],c&&(f=h.substr(0,h.indexOf(c)),f.length>0&&a._pf.unusedInput.push(f),h=h.slice(h.indexOf(c)+c.length),j+=c.length),kc[e]?(c?a._pf.empty=!1:a._pf.unusedTokens.push(e),O(e,c,a)):a._strict&&!c&&a._pf.unusedTokens.push(e);a._pf.charsLeftOver=i-j,h.length>0&&a._pf.unusedInput.push(h),a._isPm&&a._a[yb]<12&&(a._a[yb]+=12),a._isPm===!1&&12===a._a[yb]&&(a._a[yb]=0),Q(a),B(a)}function U(a){return a.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,e){return b||c||d||e})}function V(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function W(a){var b,d,e,f,g;if(0===a._f.length)return a._pf.invalidFormat=!0,void(a._d=new Date(0/0));for(f=0;f<a._f.length;f++)g=0,b=j({},a),b._pf=c(),b._f=a._f[f],T(b),C(b)&&(g+=b._pf.charsLeftOver,g+=10*b._pf.unusedTokens.length,b._pf.score=g,(null==e||e>g)&&(e=g,d=b));j(a,d||b)}function X(a){var b,c,d=a._i,e=$b.exec(d);if(e){for(a._pf.iso=!0,b=0,c=ac.length;c>b;b++)if(ac[b][1].exec(d)){a._f=ac[b][0]+(e[6]||" ");break}for(b=0,c=bc.length;c>b;b++)if(bc[b][1].exec(d)){a._f+=bc[b][0];break}d.match(Qb)&&(a._f+="Z"),T(a)}else a._isValid=!1}function Y(a){X(a),a._isValid===!1&&(delete a._isValid,pb.createFromInputFallback(a))}function Z(b){var c,d=b._i;d===a?b._d=new Date:r(d)?b._d=new Date(+d):null!==(c=Fb.exec(d))?b._d=new Date(+c[1]):"string"==typeof d?Y(b):q(d)?(b._a=d.slice(0),Q(b)):"object"==typeof d?R(b):"number"==typeof d?b._d=new Date(d):pb.createFromInputFallback(b)}function $(a,b,c,d,e,f,g){var h=new Date(a,b,c,d,e,f,g);return 1970>a&&h.setFullYear(a),h}function _(a){var b=new Date(Date.UTC.apply(null,arguments));return 1970>a&&b.setUTCFullYear(a),b}function ab(a,b){if("string"==typeof a)if(isNaN(a)){if(a=b.weekdaysParse(a),"number"!=typeof a)return null}else a=parseInt(a,10);return a}function bb(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function cb(a,b,c){var d=pb.duration(a).abs(),e=ub(d.as("s")),f=ub(d.as("m")),g=ub(d.as("h")),h=ub(d.as("d")),i=ub(d.as("M")),j=ub(d.as("y")),k=e<hc.s&&["s",e]||1===f&&["m"]||f<hc.m&&["mm",f]||1===g&&["h"]||g<hc.h&&["hh",g]||1===h&&["d"]||h<hc.d&&["dd",h]||1===i&&["M"]||i<hc.M&&["MM",i]||1===j&&["y"]||["yy",j];return k[2]=b,k[3]=+a>0,k[4]=c,bb.apply({},k)}function db(a,b,c){var d,e=c-b,f=c-a.day();return f>e&&(f-=7),e-7>f&&(f+=7),d=pb(a).add("d",f),{week:Math.ceil(d.dayOfYear()/7),year:d.year()}}function eb(a,b,c,d,e){var f,g,h=_(a,0,1).getUTCDay();return h=0===h?7:h,c=null!=c?c:e,f=e-h+(h>d?7:0)-(e>h?7:0),g=7*(b-1)+(c-e)+f+1,{year:g>0?a:a-1,dayOfYear:g>0?g:z(a-1)+g}}function fb(b){var c=b._i,d=b._f;return null===c||d===a&&""===c?pb.invalid({nullInput:!0}):("string"==typeof c&&(b._i=c=H().preparse(c)),pb.isMoment(c)?(b=k(c),b._d=new Date(+c._d)):d?q(d)?W(b):T(b):Z(b),new h(b))}function gb(a,b){var c,d;if(1===b.length&&q(b[0])&&(b=b[0]),!b.length)return pb();for(c=b[0],d=1;d<b.length;++d)b[d][a](c)&&(c=b[d]);return c}function hb(a,b){var c;return"string"==typeof b&&(b=a.lang().monthsParse(b),"number"!=typeof b)?a:(c=Math.min(a.date(),x(a.year(),b)),a._d["set"+(a._isUTC?"UTC":"")+"Month"](b,c),a)}function ib(a,b){return a._d["get"+(a._isUTC?"UTC":"")+b]()}function jb(a,b,c){return"Month"===b?hb(a,c):a._d["set"+(a._isUTC?"UTC":"")+b](c)}function kb(a,b){return function(c){return null!=c?(jb(this,a,c),pb.updateOffset(this,b),this):ib(this,a)}}function lb(a){return 400*a/146097}function mb(a){return 146097*a/400}function nb(a){pb.duration.fn[a]=function(){return this._data[a]}}function ob(a){"undefined"==typeof ender&&(qb=tb.moment,tb.moment=a?d("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",pb):pb)}for(var pb,qb,rb,sb="2.7.0",tb="undefined"!=typeof global?global:this,ub=Math.round,vb=0,wb=1,xb=2,yb=3,zb=4,Ab=5,Bb=6,Cb={},Db={_isAMomentObject:null,_i:null,_f:null,_l:null,_strict:null,_tzm:null,_isUTC:null,_offset:null,_pf:null,_lang:null},Eb="undefined"!=typeof module&&module.exports,Fb=/^\/?Date\((\-?\d+)/i,Gb=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Hb=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,Ib=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,Jb=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,Kb=/\d\d?/,Lb=/\d{1,3}/,Mb=/\d{1,4}/,Nb=/[+\-]?\d{1,6}/,Ob=/\d+/,Pb=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Qb=/Z|[\+\-]\d\d:?\d\d/gi,Rb=/T/i,Sb=/[\+\-]?\d+(\.\d{1,3})?/,Tb=/\d{1,2}/,Ub=/\d/,Vb=/\d\d/,Wb=/\d{3}/,Xb=/\d{4}/,Yb=/[+-]?\d{6}/,Zb=/[+-]?\d+/,$b=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,_b="YYYY-MM-DDTHH:mm:ssZ",ac=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],bc=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],cc=/([\+\-]|\d\d)/gi,dc=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),ec={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},fc={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},gc={},hc={s:45,m:45,h:22,d:26,M:11},ic="DDD w W M D d".split(" "),jc="M D H h m s w W".split(" "),kc={M:function(){return this.month()+1},MMM:function(a){return this.lang().monthsShort(this,a)},MMMM:function(a){return this.lang().months(this,a)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(a){return this.lang().weekdaysMin(this,a)},ddd:function(a){return this.lang().weekdaysShort(this,a)},dddd:function(a){return this.lang().weekdays(this,a)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return m(this.year()%100,2)},YYYY:function(){return m(this.year(),4)},YYYYY:function(){return m(this.year(),5)},YYYYYY:function(){var a=this.year(),b=a>=0?"+":"-";return b+m(Math.abs(a),6)},gg:function(){return m(this.weekYear()%100,2)},gggg:function(){return m(this.weekYear(),4)},ggggg:function(){return m(this.weekYear(),5)},GG:function(){return m(this.isoWeekYear()%100,2)},GGGG:function(){return m(this.isoWeekYear(),4)},GGGGG:function(){return m(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return w(this.milliseconds()/100)},SS:function(){return m(w(this.milliseconds()/10),2)},SSS:function(){return m(this.milliseconds(),3)},SSSS:function(){return m(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+m(w(a/60),2)+":"+m(w(a)%60,2)},ZZ:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+m(w(a/60),2)+m(w(a)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},lc=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];ic.length;)rb=ic.pop(),kc[rb+"o"]=f(kc[rb],rb);for(;jc.length;)rb=jc.pop(),kc[rb+rb]=e(kc[rb],2);kc.DDDD=e(kc.DDD,3),j(g.prototype,{set:function(a){var b,c;for(c in a)b=a[c],"function"==typeof b?this[c]=b:this["_"+c]=b},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(a){return this._months[a.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(a){return this._monthsShort[a.month()]},monthsParse:function(a){var b,c,d;for(this._monthsParse||(this._monthsParse=[]),b=0;12>b;b++)if(this._monthsParse[b]||(c=pb.utc([2e3,b]),d="^"+this.months(c,"")+"|^"+this.monthsShort(c,""),this._monthsParse[b]=new RegExp(d.replace(".",""),"i")),this._monthsParse[b].test(a))return b},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(a){return this._weekdays[a.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(a){return this._weekdaysShort[a.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(a){return this._weekdaysMin[a.day()]},weekdaysParse:function(a){var b,c,d;for(this._weekdaysParse||(this._weekdaysParse=[]),b=0;7>b;b++)if(this._weekdaysParse[b]||(c=pb([2e3,1]).day(b),d="^"+this.weekdays(c,"")+"|^"+this.weekdaysShort(c,"")+"|^"+this.weekdaysMin(c,""),this._weekdaysParse[b]=new RegExp(d.replace(".",""),"i")),this._weekdaysParse[b].test(a))return b},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(a){var b=this._longDateFormat[a];return!b&&this._longDateFormat[a.toUpperCase()]&&(b=this._longDateFormat[a.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)}),this._longDateFormat[a]=b),b},isPM:function(a){return"p"===(a+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(a,b,c){return a>11?c?"pm":"PM":c?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(a,b){var c=this._calendar[a];return"function"==typeof c?c.apply(b):c},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(a,b,c,d){var e=this._relativeTime[c];return"function"==typeof e?e(a,b,c,d):e.replace(/%d/i,a)},pastFuture:function(a,b){var c=this._relativeTime[a>0?"future":"past"];return"function"==typeof c?c(b):c.replace(/%s/i,b)},ordinal:function(a){return this._ordinal.replace("%d",a)},_ordinal:"%d",preparse:function(a){return a},postformat:function(a){return a},week:function(a){return db(a,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),pb=function(b,d,e,f){var g;return"boolean"==typeof e&&(f=e,e=a),g={},g._isAMomentObject=!0,g._i=b,g._f=d,g._l=e,g._strict=f,g._isUTC=!1,g._pf=c(),fb(g)},pb.suppressDeprecationWarnings=!1,pb.createFromInputFallback=d("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(a){a._d=new Date(a._i)}),pb.min=function(){var a=[].slice.call(arguments,0);return gb("isBefore",a)},pb.max=function(){var a=[].slice.call(arguments,0);return gb("isAfter",a)},pb.utc=function(b,d,e,f){var g;return"boolean"==typeof e&&(f=e,e=a),g={},g._isAMomentObject=!0,g._useUTC=!0,g._isUTC=!0,g._l=e,g._i=b,g._f=d,g._strict=f,g._pf=c(),fb(g).utc()},pb.unix=function(a){return pb(1e3*a)},pb.duration=function(a,b){var c,d,e,f,g=a,h=null;return pb.isDuration(a)?g={ms:a._milliseconds,d:a._days,M:a._months}:"number"==typeof a?(g={},b?g[b]=a:g.milliseconds=a):(h=Gb.exec(a))?(c="-"===h[1]?-1:1,g={y:0,d:w(h[xb])*c,h:w(h[yb])*c,m:w(h[zb])*c,s:w(h[Ab])*c,ms:w(h[Bb])*c}):(h=Hb.exec(a))?(c="-"===h[1]?-1:1,e=function(a){var b=a&&parseFloat(a.replace(",","."));return(isNaN(b)?0:b)*c},g={y:e(h[2]),M:e(h[3]),d:e(h[4]),h:e(h[5]),m:e(h[6]),s:e(h[7]),w:e(h[8])}):"object"==typeof g&&("from"in g||"to"in g)&&(f=o(pb(g.from),pb(g.to)),g={},g.ms=f.milliseconds,g.M=f.months),d=new i(g),pb.isDuration(a)&&a.hasOwnProperty("_lang")&&(d._lang=a._lang),d},pb.version=sb,pb.defaultFormat=_b,pb.ISO_8601=function(){},pb.momentProperties=Db,pb.updateOffset=function(){},pb.relativeTimeThreshold=function(b,c){return hc[b]===a?!1:c===a?hc[b]:(hc[b]=c,!0)},pb.lang=function(a,b){var c;return a?(b?F(D(a),b):null===b?(G(a),a="en"):Cb[a]||H(a),c=pb.duration.fn._lang=pb.fn._lang=H(a),c._abbr):pb.fn._lang._abbr},pb.langData=function(a){return a&&a._lang&&a._lang._abbr&&(a=a._lang._abbr),H(a)},pb.isMoment=function(a){return a instanceof h||null!=a&&a.hasOwnProperty("_isAMomentObject")},pb.isDuration=function(a){return a instanceof i};for(rb=lc.length-1;rb>=0;--rb)v(lc[rb]);pb.normalizeUnits=function(a){return t(a)},pb.invalid=function(a){var b=pb.utc(0/0);return null!=a?j(b._pf,a):b._pf.userInvalidated=!0,b},pb.parseZone=function(){return pb.apply(null,arguments).parseZone()},pb.parseTwoDigitYear=function(a){return w(a)+(w(a)>68?1900:2e3)},j(pb.fn=h.prototype,{clone:function(){return pb(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var a=pb(this).utc();return 0<a.year()&&a.year()<=9999?K(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):K(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var a=this;return[a.year(),a.month(),a.date(),a.hours(),a.minutes(),a.seconds(),a.milliseconds()]},isValid:function(){return C(this)},isDSTShifted:function(){return this._a?this.isValid()&&s(this._a,(this._isUTC?pb.utc(this._a):pb(this._a)).toArray())>0:!1},parsingFlags:function(){return j({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(a){return this.zone(0,a)},local:function(a){return this._isUTC&&(this.zone(0,a),this._isUTC=!1,a&&this.add(this._d.getTimezoneOffset(),"m")),this},format:function(a){var b=K(this,a||pb.defaultFormat);return this.lang().postformat(b)},add:function(a,b){var c;return c="string"==typeof a&&"string"==typeof b?pb.duration(isNaN(+b)?+a:+b,isNaN(+b)?b:a):"string"==typeof a?pb.duration(+b,a):pb.duration(a,b),p(this,c,1),this},subtract:function(a,b){var c;return c="string"==typeof a&&"string"==typeof b?pb.duration(isNaN(+b)?+a:+b,isNaN(+b)?b:a):"string"==typeof a?pb.duration(+b,a):pb.duration(a,b),p(this,c,-1),this
},diff:function(a,b,c){var d,e,f=E(a,this),g=6e4*(this.zone()-f.zone());return b=t(b),"year"===b||"month"===b?(d=432e5*(this.daysInMonth()+f.daysInMonth()),e=12*(this.year()-f.year())+(this.month()-f.month()),e+=(this-pb(this).startOf("month")-(f-pb(f).startOf("month")))/d,e-=6e4*(this.zone()-pb(this).startOf("month").zone()-(f.zone()-pb(f).startOf("month").zone()))/d,"year"===b&&(e/=12)):(d=this-f,e="second"===b?d/1e3:"minute"===b?d/6e4:"hour"===b?d/36e5:"day"===b?(d-g)/864e5:"week"===b?(d-g)/6048e5:d),c?e:l(e)},from:function(a,b){return pb.duration({to:this,from:a}).lang(this.lang()._abbr).humanize(!b)},fromNow:function(a){return this.from(pb(),a)},calendar:function(a){var b=a||pb(),c=E(b,this).startOf("day"),d=this.diff(c,"days",!0),e=-6>d?"sameElse":-1>d?"lastWeek":0>d?"lastDay":1>d?"sameDay":2>d?"nextDay":7>d?"nextWeek":"sameElse";return this.format(this.lang().calendar(e,this))},isLeapYear:function(){return A(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(a){var b=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=a?(a=ab(a,this.lang()),this.add(a-b,"days")):b},month:kb("Month",!0),startOf:function(a){switch(a=t(a)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===a?this.weekday(0):"isoWeek"===a&&this.isoWeekday(1),"quarter"===a&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(a){return a=t(a),this.startOf(a).add("isoWeek"===a?"week":a,1).subtract("ms",1)},isAfter:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)>+pb(a).startOf(b)},isBefore:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)<+pb(a).startOf(b)},isSame:function(a,b){return b=b||"ms",+this.clone().startOf(b)===+E(a,this).startOf(b)},min:d("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(a){return a=pb.apply(null,arguments),this>a?this:a}),max:d("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(a){return a=pb.apply(null,arguments),a>this?this:a}),zone:function(a,b){var c,d=this._offset||0;return null==a?this._isUTC?d:this._d.getTimezoneOffset():("string"==typeof a&&(a=N(a)),Math.abs(a)<16&&(a=60*a),!this._isUTC&&b&&(c=this._d.getTimezoneOffset()),this._offset=a,this._isUTC=!0,null!=c&&this.subtract(c,"m"),d!==a&&(!b||this._changeInProgress?p(this,pb.duration(d-a,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,pb.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(a){return a=a?pb(a).zone():0,(this.zone()-a)%60===0},daysInMonth:function(){return x(this.year(),this.month())},dayOfYear:function(a){var b=ub((pb(this).startOf("day")-pb(this).startOf("year"))/864e5)+1;return null==a?b:this.add("d",a-b)},quarter:function(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)},weekYear:function(a){var b=db(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==a?b:this.add("y",a-b)},isoWeekYear:function(a){var b=db(this,1,4).year;return null==a?b:this.add("y",a-b)},week:function(a){var b=this.lang().week(this);return null==a?b:this.add("d",7*(a-b))},isoWeek:function(a){var b=db(this,1,4).week;return null==a?b:this.add("d",7*(a-b))},weekday:function(a){var b=(this.day()+7-this.lang()._week.dow)%7;return null==a?b:this.add("d",a-b)},isoWeekday:function(a){return null==a?this.day()||7:this.day(this.day()%7?a:a-7)},isoWeeksInYear:function(){return y(this.year(),1,4)},weeksInYear:function(){var a=this._lang._week;return y(this.year(),a.dow,a.doy)},get:function(a){return a=t(a),this[a]()},set:function(a,b){return a=t(a),"function"==typeof this[a]&&this[a](b),this},lang:function(b){return b===a?this._lang:(this._lang=H(b),this)}}),pb.fn.millisecond=pb.fn.milliseconds=kb("Milliseconds",!1),pb.fn.second=pb.fn.seconds=kb("Seconds",!1),pb.fn.minute=pb.fn.minutes=kb("Minutes",!1),pb.fn.hour=pb.fn.hours=kb("Hours",!0),pb.fn.date=kb("Date",!0),pb.fn.dates=d("dates accessor is deprecated. Use date instead.",kb("Date",!0)),pb.fn.year=kb("FullYear",!0),pb.fn.years=d("years accessor is deprecated. Use year instead.",kb("FullYear",!0)),pb.fn.days=pb.fn.day,pb.fn.months=pb.fn.month,pb.fn.weeks=pb.fn.week,pb.fn.isoWeeks=pb.fn.isoWeek,pb.fn.quarters=pb.fn.quarter,pb.fn.toJSON=pb.fn.toISOString,j(pb.duration.fn=i.prototype,{_bubble:function(){var a,b,c,d=this._milliseconds,e=this._days,f=this._months,g=this._data,h=0;g.milliseconds=d%1e3,a=l(d/1e3),g.seconds=a%60,b=l(a/60),g.minutes=b%60,c=l(b/60),g.hours=c%24,e+=l(c/24),h=l(lb(e)),e-=l(mb(h)),f+=l(e/30),e%=30,h+=l(f/12),f%=12,g.days=e,g.months=f,g.years=h},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return l(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*w(this._months/12)},humanize:function(a){var b=cb(this,!a,this.lang());return a&&(b=this.lang().pastFuture(+this,b)),this.lang().postformat(b)},add:function(a,b){var c=pb.duration(a,b);return this._milliseconds+=c._milliseconds,this._days+=c._days,this._months+=c._months,this._bubble(),this},subtract:function(a,b){var c=pb.duration(a,b);return this._milliseconds-=c._milliseconds,this._days-=c._days,this._months-=c._months,this._bubble(),this},get:function(a){return a=t(a),this[a.toLowerCase()+"s"]()},as:function(a){var b,c;if(a=t(a),b=this._days+this._milliseconds/864e5,"month"===a||"year"===a)return c=this._months+12*lb(b),"month"===a?c:c/12;switch(b+=mb(this._months/12),a){case"week":return b/7;case"day":return b;case"hour":return 24*b;case"minute":return 24*b*60;case"second":return 24*b*60*60;case"millisecond":return 24*b*60*60*1e3;default:throw new Error("Unknown unit "+a)}},lang:pb.fn.lang,toIsoString:function(){var a=Math.abs(this.years()),b=Math.abs(this.months()),c=Math.abs(this.days()),d=Math.abs(this.hours()),e=Math.abs(this.minutes()),f=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(a?a+"Y":"")+(b?b+"M":"")+(c?c+"D":"")+(d||e||f?"T":"")+(d?d+"H":"")+(e?e+"M":"")+(f?f+"S":""):"P0D"}});for(rb in dc)dc.hasOwnProperty(rb)&&nb(rb.toLowerCase());pb.duration.fn.asMilliseconds=function(){return this.as("ms")},pb.duration.fn.asSeconds=function(){return this.as("s")},pb.duration.fn.asMinutes=function(){return this.as("m")},pb.duration.fn.asHours=function(){return this.as("h")},pb.duration.fn.asDays=function(){return this.as("d")},pb.duration.fn.asWeeks=function(){return this.as("weeks")},pb.duration.fn.asMonths=function(){return this.as("M")},pb.duration.fn.asYears=function(){return this.as("y")},pb.lang("en",{ordinal:function(a){var b=a%10,c=1===w(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c}}),Eb?module.exports=pb:"function"==typeof define&&define.amd?(define("moment",function(a,b,c){return c.config&&c.config()&&c.config().noGlobal===!0&&(tb.moment=qb),pb}),ob(!0)):ob()}.call(this);var mod=angular.module("infinite-scroll",[]);mod.directive("infiniteScroll",["$rootScope","$window","$timeout",function(a,b,c){return{link:function(d,e,f){var g,h,i,j,k,l;return b=angular.element(b),g=e.parents().filter(function(){return/(auto|scroll)/.test($.css(this,"overflow")+$.css(this,"overflow-y"))}).eq(0),0===g.length&&(g=b),null!=f.infiniteScrollSelf&&(g=e),k=0,null!=f.infiniteScrollDistance&&d.$watch(f.infiniteScrollDistance,function(a){return k=parseFloat(a,10)}),l=!0,h=!1,null!=f.infiniteScrollDisabled&&d.$watch(f.infiniteScrollDisabled,function(a){return l=!a,l&&h?(h=!1,j()):void 0}),i=e.position().top,j=function(){var b,c,j,m;return e==g?(c=e[0].scrollHeight-e.scrollTop()-e.height(),m=c<=e[0].scrollHeight*k):(b=i+e.height(),j=g.height()+g.scrollTop(),c=b-j,m=c<=g.height()*k),m&&l?a.$$phase?d.$eval(f.infiniteScroll):d.$apply(f.infiniteScroll):m?h=!0:void 0},g.on("scroll",j),j(),d.$on("$destroy",function(){return g.off("scroll",j)}),c(function(){return f.infiniteScrollImmediateCheck?d.$eval(f.infiniteScrollImmediateCheck)?j():void 0:j()},0)}}}]),function(a){"use strict";function b(a){return a.replace(c,function(a,b,c,d){return d?c.toUpperCase():c}).replace(d,"Moz$1")}var c=/([\:\-\_]+(.))/g,d=/^moz([A-Z])/;a.module("translate",[],["$provide",function(b){b.factory("translate",["$log",function(b){var c={},d=!1,e=function(a,e){return a?(a=$.trim(a),a=a.replace(/<!--IE fix-->/g,""),a=a.replace(/ class="ng-binding"/g,""),c[e||"default"][a]?c[e||"default"][a]:(d&&b.warn('Missing localisation for "'+a+'"'),a)):""};return e.add=function(b,d){a.isUndefined(c[d||"default"])&&(c[d||"default"]={}),a.extend(c[d||"default"],b)},e.remove=function(a,b){return c[b||"default"][a]?(delete c[b||"default"][a],!0):!1},e.set=function(a,b){c[b||"default"]=a},e.logMissedHits=function(a){d=a},e}])}]),a.module("translate.directives",["translate"],["$compileProvider",function(c){c.directive("translate",["$compile","translate",function(c,d){return{priority:10,restrict:"ECMA",compile:function(e,f){var g=!1;if(f.translate){var h=f.translate.split(" ");a.forEach(h,function(a){e.attr(a,d(f[b(a)]))}),g=h.indexOf("innerHTML")>=0}else g=!0;return function(a,b){g&&b.html(d(b.html()));try{c(b.contents())(a)}catch(e){}}}}}])}]),a.module("translate.filters",["translate"]).filter("translate",["translate",function(a){return function(b){return a(b)}}])}(angular),function(){function a(a){var c={r:0,g:0,b:0},e=1,g=!1,h=!1;return"string"==typeof a&&(a=t(a)),"object"==typeof a&&(a.hasOwnProperty("r")&&a.hasOwnProperty("g")&&a.hasOwnProperty("b")?(c=b(a.r,a.g,a.b),g=!0,h="%"===String(a.r).substr(-1)?"prgb":"rgb"):a.hasOwnProperty("h")&&a.hasOwnProperty("s")&&a.hasOwnProperty("v")?(a.s=q(a.s),a.v=q(a.v),c=f(a.h,a.s,a.v),g=!0,h="hsv"):a.hasOwnProperty("h")&&a.hasOwnProperty("s")&&a.hasOwnProperty("l")&&(a.s=q(a.s),a.l=q(a.l),c=d(a.h,a.s,a.l),g=!0,h="hsl"),a.hasOwnProperty("a")&&(e=a.a)),e=j(e),{ok:g,format:a.format||h,r:z(255,A(c.r,0)),g:z(255,A(c.g,0)),b:z(255,A(c.b,0)),a:e}}function b(a,b,c){return{r:255*k(a,255),g:255*k(b,255),b:255*k(c,255)}}function c(a,b,c){a=k(a,255),b=k(b,255),c=k(c,255);var d,e,f=A(a,b,c),g=z(a,b,c),h=(f+g)/2;if(f==g)d=e=0;else{var i=f-g;switch(e=h>.5?i/(2-f-g):i/(f+g),f){case a:d=(b-c)/i+(c>b?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,l:h}}function d(a,b,c){function d(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+(b-a)*(2/3-c)*6:a}var e,f,g;if(a=k(a,360),b=k(b,100),c=k(c,100),0===b)e=f=g=c;else{var h=.5>c?c*(1+b):c+b-c*b,i=2*c-h;e=d(i,h,a+1/3),f=d(i,h,a),g=d(i,h,a-1/3)}return{r:255*e,g:255*f,b:255*g}}function e(a,b,c){a=k(a,255),b=k(b,255),c=k(c,255);var d,e,f=A(a,b,c),g=z(a,b,c),h=f,i=f-g;if(e=0===f?0:i/f,f==g)d=0;else{switch(f){case a:d=(b-c)/i+(c>b?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,v:h}}function f(a,b,c){a=6*k(a,360),b=k(b,100),c=k(c,100);var d=x.floor(a),e=a-d,f=c*(1-b),g=c*(1-e*b),h=c*(1-(1-e)*b),i=d%6,j=[c,g,f,f,h,c][i],l=[h,c,c,g,f,f][i],m=[f,f,h,c,c,g][i];return{r:255*j,g:255*l,b:255*m}}function g(a,b,c,d){var e=[p(y(a).toString(16)),p(y(b).toString(16)),p(y(c).toString(16))];return d&&e[0].charAt(0)==e[0].charAt(1)&&e[1].charAt(0)==e[1].charAt(1)&&e[2].charAt(0)==e[2].charAt(1)?e[0].charAt(0)+e[1].charAt(0)+e[2].charAt(0):e.join("")}function h(a,b,c,d){var e=[p(r(d)),p(y(a).toString(16)),p(y(b).toString(16)),p(y(c).toString(16))];return e.join("")}function i(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[a[c]]=c);return b}function j(a){return a=parseFloat(a),(isNaN(a)||0>a||a>1)&&(a=1),a}function k(a,b){n(a)&&(a="100%");var c=o(a);return a=z(b,A(0,parseFloat(a))),c&&(a=parseInt(a*b,10)/100),x.abs(a-b)<1e-6?1:a%b/parseFloat(b)}function l(a){return z(1,A(0,a))}function m(a){return parseInt(a,16)}function n(a){return"string"==typeof a&&-1!=a.indexOf(".")&&1===parseFloat(a)}function o(a){return"string"==typeof a&&-1!=a.indexOf("%")}function p(a){return 1==a.length?"0"+a:""+a}function q(a){return 1>=a&&(a=100*a+"%"),a}function r(a){return Math.round(255*parseFloat(a)).toString(16)}function s(a){return m(a)/255}function t(a){a=a.replace(u,"").replace(v,"").toLowerCase();var b=!1;if(D[a])a=D[a],b=!0;else if("transparent"==a)return{r:0,g:0,b:0,a:0,format:"name"};var c;return(c=F.rgb.exec(a))?{r:c[1],g:c[2],b:c[3]}:(c=F.rgba.exec(a))?{r:c[1],g:c[2],b:c[3],a:c[4]}:(c=F.hsl.exec(a))?{h:c[1],s:c[2],l:c[3]}:(c=F.hsla.exec(a))?{h:c[1],s:c[2],l:c[3],a:c[4]}:(c=F.hsv.exec(a))?{h:c[1],s:c[2],v:c[3]}:(c=F.hex8.exec(a))?{a:s(c[1]),r:m(c[2]),g:m(c[3]),b:m(c[4]),format:b?"name":"hex8"}:(c=F.hex6.exec(a))?{r:m(c[1]),g:m(c[2]),b:m(c[3]),format:b?"name":"hex"}:(c=F.hex3.exec(a))?{r:m(c[1]+""+c[1]),g:m(c[2]+""+c[2]),b:m(c[3]+""+c[3]),format:b?"name":"hex"}:!1}var u=/^[\s,#]+/,v=/\s+$/,w=0,x=Math,y=x.round,z=x.min,A=x.max,B=x.random,C=function G(b,c){if(b=b?b:"",c=c||{},b instanceof G)return b;if(!(this instanceof G))return new G(b,c);var d=a(b);this._r=d.r,this._g=d.g,this._b=d.b,this._a=d.a,this._roundA=y(100*this._a)/100,this._format=c.format||d.format,this._gradientType=c.gradientType,this._r<1&&(this._r=y(this._r)),this._g<1&&(this._g=y(this._g)),this._b<1&&(this._b=y(this._b)),this._ok=d.ok,this._tc_id=w++};C.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var a=this.toRgb();return(299*a.r+587*a.g+114*a.b)/1e3},setAlpha:function(a){return this._a=j(a),this._roundA=y(100*this._a)/100,this},toHsv:function(){var a=e(this._r,this._g,this._b);return{h:360*a.h,s:a.s,v:a.v,a:this._a}},toHsvString:function(){var a=e(this._r,this._g,this._b),b=y(360*a.h),c=y(100*a.s),d=y(100*a.v);return 1==this._a?"hsv("+b+", "+c+"%, "+d+"%)":"hsva("+b+", "+c+"%, "+d+"%, "+this._roundA+")"},toHsl:function(){var a=c(this._r,this._g,this._b);return{h:360*a.h,s:a.s,l:a.l,a:this._a}},toHslString:function(){var a=c(this._r,this._g,this._b),b=y(360*a.h),d=y(100*a.s),e=y(100*a.l);return 1==this._a?"hsl("+b+", "+d+"%, "+e+"%)":"hsla("+b+", "+d+"%, "+e+"%, "+this._roundA+")"},toHex:function(a){return g(this._r,this._g,this._b,a)},toHexString:function(a){return"#"+this.toHex(a)},toHex8:function(){return h(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:y(this._r),g:y(this._g),b:y(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+y(this._r)+", "+y(this._g)+", "+y(this._b)+")":"rgba("+y(this._r)+", "+y(this._g)+", "+y(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:y(100*k(this._r,255))+"%",g:y(100*k(this._g,255))+"%",b:y(100*k(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+y(100*k(this._r,255))+"%, "+y(100*k(this._g,255))+"%, "+y(100*k(this._b,255))+"%)":"rgba("+y(100*k(this._r,255))+"%, "+y(100*k(this._g,255))+"%, "+y(100*k(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":this._a<1?!1:E[g(this._r,this._g,this._b,!0)]||!1},toFilter:function(a){var b="#"+h(this._r,this._g,this._b,this._a),c=b,d=this._gradientType?"GradientType = 1, ":"";if(a){var e=C(a);c=e.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+d+"startColorstr="+b+",endColorstr="+c+")"},toString:function(a){var b=!!a;a=a||this._format;var c=!1,d=this._a<1&&this._a>=0,e=!b&&d&&("hex"===a||"hex6"===a||"hex3"===a||"name"===a);return e?"name"===a&&0===this._a?this.toName():this.toRgbString():("rgb"===a&&(c=this.toRgbString()),"prgb"===a&&(c=this.toPercentageRgbString()),("hex"===a||"hex6"===a)&&(c=this.toHexString()),"hex3"===a&&(c=this.toHexString(!0)),"hex8"===a&&(c=this.toHex8String()),"name"===a&&(c=this.toName()),"hsl"===a&&(c=this.toHslString()),"hsv"===a&&(c=this.toHsvString()),c||this.toHexString())}},C.fromRatio=function(a,b){if("object"==typeof a){var c={};for(var d in a)a.hasOwnProperty(d)&&(c[d]="a"===d?a[d]:q(a[d]));a=c}return C(a,b)},C.equals=function(a,b){return a&&b?C(a).toRgbString()==C(b).toRgbString():!1},C.random=function(){return C.fromRatio({r:B(),g:B(),b:B()})},C.desaturate=function(a,b){b=0===b?0:b||10;var c=C(a).toHsl();return c.s-=b/100,c.s=l(c.s),C(c)},C.saturate=function(a,b){b=0===b?0:b||10;var c=C(a).toHsl();return c.s+=b/100,c.s=l(c.s),C(c)},C.greyscale=function(a){return C.desaturate(a,100)},C.lighten=function(a,b){b=0===b?0:b||10;var c=C(a).toHsl();return c.l+=b/100,c.l=l(c.l),C(c)},C.brighten=function(a,b){b=0===b?0:b||10;var c=C(a).toRgb();return c.r=A(0,z(255,c.r-y(255*-(b/100)))),c.g=A(0,z(255,c.g-y(255*-(b/100)))),c.b=A(0,z(255,c.b-y(255*-(b/100)))),C(c)},C.darken=function(a,b){b=0===b?0:b||10;var c=C(a).toHsl();return c.l-=b/100,c.l=l(c.l),C(c)},C.complement=function(a){var b=C(a).toHsl();return b.h=(b.h+180)%360,C(b)},C.spin=function(a,b){var c=C(a).toHsl(),d=(y(c.h)+b)%360;return c.h=0>d?360+d:d,C(c)},C.mix=function(a,b,c){c=0===c?0:c||50;var d,e=C(a).toRgb(),f=C(b).toRgb(),g=c/100,h=2*g-1,i=f.a-e.a;d=h*i==-1?h:(h+i)/(1+h*i),d=(d+1)/2;var j=1-d,k={r:f.r*d+e.r*j,g:f.g*d+e.g*j,b:f.b*d+e.b*j,a:f.a*g+e.a*(1-g)};return C(k)},C.triad=function(a){var b=C(a).toHsl(),c=b.h;return[C(a),C({h:(c+120)%360,s:b.s,l:b.l}),C({h:(c+240)%360,s:b.s,l:b.l})]},C.tetrad=function(a){var b=C(a).toHsl(),c=b.h;return[C(a),C({h:(c+90)%360,s:b.s,l:b.l}),C({h:(c+180)%360,s:b.s,l:b.l}),C({h:(c+270)%360,s:b.s,l:b.l})]},C.splitcomplement=function(a){var b=C(a).toHsl(),c=b.h;return[C(a),C({h:(c+72)%360,s:b.s,l:b.l}),C({h:(c+216)%360,s:b.s,l:b.l})]},C.analogous=function(a,b,c){b=b||6,c=c||30;var d=C(a).toHsl(),e=360/c,f=[C(a)];for(d.h=(d.h-(e*b>>1)+720)%360;--b;)d.h=(d.h+e)%360,f.push(C(d));return f},C.monochromatic=function(a,b){b=b||6;for(var c=C(a).toHsv(),d=c.h,e=c.s,f=c.v,g=[],h=1/b;b--;)g.push(C({h:d,s:e,v:f})),f=(f+h)%1;return g},C.readability=function(a,b){var c=C(a),d=C(b),e=c.toRgb(),f=d.toRgb(),g=c.getBrightness(),h=d.getBrightness(),i=Math.max(e.r,f.r)-Math.min(e.r,f.r)+Math.max(e.g,f.g)-Math.min(e.g,f.g)+Math.max(e.b,f.b)-Math.min(e.b,f.b);return{brightness:Math.abs(g-h),color:i}},C.readable=function(a,b){var c=C.readability(a,b);return c.brightness>125&&c.color>500},C.mostReadable=function(a,b){for(var c=null,d=0,e=!1,f=0;f<b.length;f++){var g=C.readability(a,b[f]),h=g.brightness>125&&g.color>500,i=3*(g.brightness/125)+g.color/500;(h&&!e||h&&e&&i>d||!h&&!e&&i>d)&&(e=h,d=i,c=C(b[f]))}return c};var D=C.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},E=C.hexNames=i(D),F=function(){var a="[-\\+]?\\d+%?",b="[-\\+]?\\d*\\.\\d+%?",c="(?:"+b+")|(?:"+a+")",d="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?",e="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?";return{rgb:new RegExp("rgb"+d),rgba:new RegExp("rgba"+e),hsl:new RegExp("hsl"+d),hsla:new RegExp("hsla"+e),hsv:new RegExp("hsv"+d),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();"undefined"!=typeof module&&module.exports?module.exports=C:"function"==typeof define&&define.amd?define(function(){return C}):window.tinycolor=C}(),function(){"use strict";var a=angular.module("ods-widgets",["infinite-scroll","ngSanitize","translate","translate.directives","translate.filters"]);a.provider("ODSWidgetsConfig",function(){this.defaultConfig={defaultDomain:"",language:null,disqusShortname:null,customAPIHeaders:null,basemaps:[{provider:"mapquest",label:"MapQuest"}],mapGeobox:!1,chartColors:null,mapPrependAttribution:null,basePath:null,websiteName:null,themes:{}},this.customConfig={},this.setConfig=function(a){angular.extend(this.customConfig,a)},this.$get=function(){return angular.extend({},this.defaultConfig,this.customConfig)}}),a.service("ODSAPI",["$http","ODSWidgetsConfig",function(a,b){var c=function(c,d,e,f){var g=c.domainUrl;g+=d,e=e||{},c.apikey&&(e.apikey=c.apikey);var h={params:e};return f&&(h.timeout=f),b.customAPIHeaders&&(h.headers=b.customAPIHeaders),a.get(g,h)};return{getDomainURL:function(a){var c=null;return angular.isUndefined(a)||null===a||""===a?c=b.defaultDomain:(c="/"!==a.substr(0,1)&&-1===a.indexOf(".")?a+".opendatasoft.com":a,"/"!==c.substr(0,1)&&-1===c.indexOf("http://")&&-1===c.indexOf("https://")&&(c="https://"+c)),"/"===c.substr(-1)&&(c=c.substr(0,c.length-1)),c},datasets:{get:function(a,b,d){return c(a,"/api/datasets/1.0/"+b+"/",d)},search:function(a,b){var d=angular.extend({},a.parameters,b);return c(a,"/api/datasets/1.0/search/",d)},facets:function(a,b){return this.search(a,{rows:0,facet:b})}},records:{analyze:function(a,b){return c(a,"/api/records/1.0/analyze/",angular.extend({},b,{dataset:a.dataset.datasetid}))},search:function(a,b){return c(a,"/api/records/1.0/search/",angular.extend({},b,{dataset:a.dataset.datasetid}))},download:function(a,b){return c(a,"/api/records/1.0/download/",angular.extend({},b,{dataset:a.dataset.datasetid}))},geo:function(a,b,d){return c(a,"/api/records/1.0/geocluster/",angular.extend({},b,{dataset:a.dataset.datasetid}),d)},geopreview:function(a,b,d){return c(a,"/api/records/1.0/geopreview/",angular.extend({},b,{dataset:a.dataset.datasetid}),d)},boundingbox:function(a,b,d){return c(a,"/api/records/1.0/boundingbox/",angular.extend({},b,{dataset:a.dataset.datasetid}),d)}},reuses:function(a,b){return c(a,"/explore/reuses/",b)}}}]),a.provider("ModuleLazyLoader",function(){var a={highcharts:{css:[],js:[["//code.highcharts.com/3.0.7/highcharts.js"],["//code.highcharts.com/3.0.7/highcharts-more.js"]]},leaflet:{css:["//cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.css","//api.tiles.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v0.0.3/leaflet.fullscreen.css","//api.tiles.mapbox.com/mapbox.js/plugins/leaflet-locatecontrol/v0.24.0/L.Control.Locate.css","libs/ods-geobox/geobox.css","libs/ods-vectormarker/vectormarker.css","libs/ods-clustermarker/clustermarker.css"],js:[["L@//cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.js"],["L.Control.FullScreen@//api.tiles.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v0.0.3/Leaflet.fullscreen.min.js","L.Control.Locate@//api.tiles.mapbox.com/mapbox.js/plugins/leaflet-locatecontrol/v0.24.0/L.Control.Locate.js","L.ODSMap@libs/ods-map/ods-map.js","L.ODSTileLayer@libs/ods-map/ods-tilelayer.js","L.Control.GeoBox@libs/ods-geobox/geobox.js","L.VectorMarker@libs/ods-vectormarker/vectormarker.js","L.ClusterMarker@libs/ods-clustermarker/clustermarker.js"]]}};this.getConfig=function(){return a};var b=function(a,c){var d=c.split(".");if(a.hasOwnProperty(d[0])&&angular.isDefined(a[d[0]])){if(1===d.length)return!0;var e=a[d[0]];return d.shift(),b(e,d.join("."))}return!1},c=function(a){return b(window,a)};this.$get=["$q","ODSWidgetsConfig",function(b,d){var e={},f=[],g=function(a,c){if(angular.isDefined(e[c]))return e[c];var g=b.defer(),h="/"===c.substring(0,1)||"http://"===c.substring(0,7)||"https://"===c.substring(0,8)?c:d.basePath+c;return LazyLoad[a](h,function(){f.push(c),g.resolve()}),e[c]=g,g};return function(d){for(var e=a[d],h=[],i=0;i<e.css.length;i++)-1===f.indexOf(e.css[i])&&h.push(g("css",e.css[i]).promise);for(var j=b.defer(),k=null,l=0;l<e.js.length;l++){var m=e.js[l];angular.isArray(m)||(m=[m]);for(var n=[],o=0;o<m.length;o++){var p,q=m[o].split("@");if(q.length>1){if(c(q[0]))continue;p=q[1]}else p=q[0];-1===f.indexOf(p)&&n.push(g("js",p).promise)}k=k?k.then(function(){return b.all(n)}):b.all(n)}return k.then(function(){j.resolve()}),h.push(j.promise),b.all(h)}}]}),a.factory("DebugLogger",["$window",function(a){return{log:function(){("#debug"==a.location.hash||a.location.hash.indexOf("debug=")>=0||$(document.body).hasClass("showDebug"))&&console.log.apply(console,arguments)}}}]),a.run(["translate","ODSWidgetsConfig",function(a,b){if(a.add({}),!b.basePath){var c,d,e,f,g=document.getElementsByTagName("script"),h=/[\/^]ods-widgets(\.min)?\.js\??/;for(c=0;c<g.length;c++)d=g[c].src,e=d.match(h),e&&(f=d.split(h)[0],b.basePath=f?".js"===f.substring(f.length-3)?"":f+"/":"/")}}]),a.directive("inject",function(){return{link:function(a,b,c,d,e){var f=a.$new();e(f,function(a){b.empty(),b.append(a),b.on("$destroy",function(){f.$destroy()})})}}})}(),function(){"use strict";var a=angular.module("ods-widgets");a.filter("nofollow",function(){return function(a){return angular.isString(a)?a.replace(/<a href="/g,'<a target="_blank" rel="nofollow" href="'):a}}),a.filter("prettyText",["$filter",function(a){function b(a){return a.replace(/&/g,"&amp;").replace(d,function(a){return"&#"+a.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var c=/[<>]+/,d=/([^\#-~| |!])/g;return function(d){return d&&angular.isString(d)?c.test(d)?b(d):a("linky")(d,"_blank"):d}}]),a.filter("imagify",["$sce",function(a){var b=/^(http(?:s?):\/\/[^;,]*(?:jpg|jpeg|png|gif))(?:$|\?.*|;|,|&)/i;return function(c){if(angular.isString(c)){c=c.trim();var d=b.exec(c);if(null!==d)return a.trustAsHtml('<img class="imagify" src="'+d[1]+'" />')}return c}}]),a.filter("isDefined",function(){return function(a){return angular.isDefined(a)}}),a.filter("displayImageValue",function(a){return function(b,c){if(!b)return b;var d="/explore/dataset/"+c+"/images/"+b.id+"/300/";return a.trustAsHtml('<img class="imagify" src="'+d+'" />')}}),a.filter("fieldsForVisualization",function(){var a={table:["image"],map:["geo_point_2d","geo_shape"],images:["image"]};return function(b,c){if(angular.isUndefined(b))return b;if(angular.isUndefined(a[c]))throw'Unknown visualization type "'+c+"'";return b.filter(function(b){return-1===a[c].indexOf(b.type)})}}),a.filter("formatFieldValue",["$filter",function(a){var b=function(a){if(a.annotations){var b=a.annotations.filter(function(a){return"timeserie_precision"===a.name});if(b.length>0)return b[0].args[0]}return null};return function(c,d){var e=c[d.name];if(null===e||void 0===e)return"";if("int"===d.type||"double"===d.type){var f="";if(d.annotations)for(var g=0;g<d.annotations.length;g++)"unit"===d.annotations[g].name&&(f=" "+d.annotations[g].args[0]);return a("number")(e)+f}if("geo_point_2d"===d.type)return e[0]+", "+e[1];if("geo_shape"===d.type)return angular.toJson(e);if("date"===d.type){var h=b(d);return"year"===h?a("moment")(e,"YYYY"):"month"===h?a("capitalize")(a("moment")(e,"MMMM YYYY")):a("moment")(e,"LL")}return"datetime"===d.type?(19===e.length&&(e+="Z"),a("moment")(e,"LLL")):""+e}}]),a.filter("truncate",function(){return function(a,b){return a&&angular.isString(a)?(b||(b=200),a.substring(0,b)):a}}),a.filter("fieldsFilter",function(){return function(a,b){if(!a)return a;if(angular.isArray(b)&&b.length){var c=[];return angular.forEach(b,function(b){var d=$.grep(a,function(a){return a.name===b})[0];angular.isDefined(d)&&c.push(d)}),c}return a}}),a.filter("moment",[function(){return function(a,b){return a?moment(a).format(b):void 0}}]),a.filter("timesince",[function(){return function(a){return a?moment(a).fromNow():void 0}}]),a.filter("themeSlug",["$filter",function(a){return function(b){return!b||angular.isArray(b)&&0===b.length?b:(angular.isArray(b)&&(b=b[0]),a("slugify")(a("normalize")(b)))}}]),a.filter("slugify",function(){return function(a){return a?ODS.StringUtils.slugify(a):a}}),a.filter("normalize",[function(){var a=[{base:"A",letters:/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g},{base:"AA",letters:/[\uA732]/g},{base:"AE",letters:/[\u00C6\u01FC\u01E2]/g},{base:"AO",letters:/[\uA734]/g},{base:"AU",letters:/[\uA736]/g},{base:"AV",letters:/[\uA738\uA73A]/g},{base:"AY",letters:/[\uA73C]/g},{base:"B",letters:/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g},{base:"C",letters:/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g},{base:"D",letters:/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g},{base:"DZ",letters:/[\u01F1\u01C4]/g},{base:"Dz",letters:/[\u01F2\u01C5]/g},{base:"E",letters:/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g},{base:"F",letters:/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g},{base:"G",letters:/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g},{base:"H",letters:/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g},{base:"I",letters:/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g},{base:"J",letters:/[\u004A\u24BF\uFF2A\u0134\u0248]/g},{base:"K",letters:/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g},{base:"L",letters:/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g},{base:"LJ",letters:/[\u01C7]/g},{base:"Lj",letters:/[\u01C8]/g},{base:"M",letters:/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g},{base:"N",letters:/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g},{base:"NJ",letters:/[\u01CA]/g},{base:"Nj",letters:/[\u01CB]/g},{base:"O",letters:/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g},{base:"OI",letters:/[\u01A2]/g},{base:"OO",letters:/[\uA74E]/g},{base:"OU",letters:/[\u0222]/g},{base:"P",letters:/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g},{base:"Q",letters:/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g},{base:"R",letters:/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g},{base:"S",letters:/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g},{base:"T",letters:/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g},{base:"TZ",letters:/[\uA728]/g},{base:"U",letters:/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g},{base:"V",letters:/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g},{base:"VY",letters:/[\uA760]/g},{base:"W",letters:/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g},{base:"X",letters:/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g},{base:"Y",letters:/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g},{base:"Z",letters:/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g},{base:"a",letters:/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g},{base:"aa",letters:/[\uA733]/g},{base:"ae",letters:/[\u00E6\u01FD\u01E3]/g},{base:"ao",letters:/[\uA735]/g},{base:"au",letters:/[\uA737]/g},{base:"av",letters:/[\uA739\uA73B]/g},{base:"ay",letters:/[\uA73D]/g},{base:"b",letters:/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g},{base:"c",letters:/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g},{base:"d",letters:/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g},{base:"dz",letters:/[\u01F3\u01C6]/g},{base:"e",letters:/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g},{base:"f",letters:/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g},{base:"g",letters:/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g},{base:"h",letters:/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g},{base:"hv",letters:/[\u0195]/g},{base:"i",letters:/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g},{base:"j",letters:/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g},{base:"k",letters:/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g},{base:"l",letters:/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g},{base:"lj",letters:/[\u01C9]/g},{base:"m",letters:/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g},{base:"n",letters:/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g},{base:"nj",letters:/[\u01CC]/g},{base:"o",letters:/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g},{base:"oi",letters:/[\u01A3]/g},{base:"ou",letters:/[\u0223]/g},{base:"oo",letters:/[\uA74F]/g},{base:"p",letters:/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g},{base:"q",letters:/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g},{base:"r",letters:/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g},{base:"s",letters:/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g},{base:"t",letters:/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g},{base:"tz",letters:/[\uA729]/g},{base:"u",letters:/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},{base:"v",letters:/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g},{base:"vy",letters:/[\uA761]/g},{base:"w",letters:/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g},{base:"x",letters:/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g},{base:"y",letters:/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g},{base:"z",letters:/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g}];
return function(b){if(!b)return b;for(var c=0;c<a.length;c++)b=b.replace(a[c].letters,a[c].base);return b}}]),a.filter("shortSummary",[function(){return function(a){if(!a)return"";var b="",c=angular.element("<div>"+a+"</div>");if(0===c.children().length)b=a.indexOf("\n")>-1?a.substring(0,a.indexOf("\n")):a;else{var d=c.contents()[0];b=3==d.nodeType?d.textContent:c.find("p").length>0?c.find("p")[0].textContent:c.text()}return b.length>400&&(b=b.substring(0,397)+""),b}}])}(),function(a){var b={GeoFilter:{getBboxParameterAsBounds:function(a){var b=a.split(",");return[[b[0],b[1]],[b[2],b[3]]]},getBoundsAsBboxParameter:function(a){return angular.isArray(a)?[a[0][0],a[0][1],a[1][0],a[1][1]].join(","):[a.getSouthWest().lat,a.getSouthWest().lng,a.getNorthEast().lat,a.getNorthEast().lng].join(",")},getBoundsAsPolygonParameter:function(a){var b;b=angular.isArray(a)?new L.LatLngBounds(a):a;for(var c=[[b.getNorthWest().lat,b.getNorthWest().lng],[b.getNorthEast().lat,b.getNorthEast().lng],[b.getSouthEast().lat,b.getSouthEast().lng],[b.getSouthWest().lat,b.getSouthWest().lng]],d=[],e=0;e<c.length;e++){var f=c[e];d.push(f.join(","))}var g="("+d.join("),(")+")";return g},getPolygonParameterAsBounds:function(a){for(var b,c,d,e,f=a.replace(/[()]/g,"").split(","),g=0;g<f.length;g+=2){var h=f[g],i=f[g+1];(!b||b>h)&&(b=h),(!c||c>i)&&(c=i),(!d||h>d)&&(d=h),(!e||i>e)&&(e=i)}return[[b,c],[d,e]]},getBboxParameterAsPolygonParameter:function(a){return this.getBoundsAsPolygonParameter(this.getBboxParameterAsBounds(a))},getGeoJSONPolygonAsPolygonParameter:function(a){for(var b=a.coordinates[0],c=[],d=0;d<b.length;d++){var e=angular.copy(b[d]);e.length>2&&e.splice(2,1),e.reverse(),c.push(e.join(","))}return"("+c.join("),(")+")"}},StringUtils:{slugify:function(a){return a?a.toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/-+/g,"-"):a}},DatasetUtils:{isFieldSortable:function(a){var b=["int","double","date","datetime"];if(b.indexOf(a.type)>=0)return!0;if("text"===a.type&&a.annotations)for(var c=0;c<a.annotations.length;c++){var d=a.annotations[c];if("sortable"===d.name)return!0}return!1}}};a.ODS=b}(window),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsCatalogContext",["ODSAPI",function(a){return{restrict:"AE",scope:!0,replace:!0,link:function(b,c,d){for(var e=d.context.split(","),f=0;f<e.length;f++){var g=e[f].trim(),h=d[g+"Domain"];b[g]={name:g,type:"catalog",domain:h,domainUrl:a.getDomainURL(h),apikey:d[g+"Apikey"],parameters:b.$eval(d[g+"Parameters"])||{}}}}}}])}(),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsDatasetCard",function(){return{restrict:"E",scope:{context:"="},template:'<div class="odswidget odswidget-dataset-card"><div class="card-container" ng-class="{expanded: expanded, expandable: isExpandable()}"><h2 class="dataset-title" ng-click="expanded = !expanded" ng-show="!expanded || (expanded && !context.dataset.metas.description)">{{context.dataset.metas.title}}</h2><div ng-click="expanded = !expanded" class="expand-control"><translate>Details</translate> <i class="icon-chevron-down" ng-show="!expanded"></i><i class="icon-chevron-up" ng-hide="!expanded"></i></div><div class="dataset-expanded" ng-click="expanded = !expanded""><h2 class="dataset-title" ng-show="expanded">{{context.dataset.metas.title}}</h2><p class="dataset-description" ng-if="expanded" ng-bind-html="safeHtml(context.dataset.metas.description)"></p></div><div class="dataset-infos"><span class="dataset-infos-text"><a ng-href="{{datasetUrl}}" target="_blank" ng-bind-html="websiteName"></a><span ng-show="context.dataset.metas.license"> - <span translate>License</span> {{context.dataset.metas.license}}</span></span></div></div><div class="dataset-item"></div></div>',replace:!0,transclude:!0,link:function(a,b){a.renderContent=function(c){var d=b.find(".dataset-item").first(),e=b.find(".card-container"),f=$(e).outerHeight();$(d).css("top",f),$(d).height(b.outerHeight()-f),c(function(a){a.css("height","100%"),$(d).append(a)}),a.$apply()}},controller:["$scope","ODSWidgetsConfig","$transclude","$sce",function(a,b,c,d){a.websiteName=b.websiteName,a.expanded=!1,a.safeHtml=function(a){return d.trustAsHtml(a)},a.isExpandable=function(){return a.context&&a.context.dataset&&a.context.dataset.datasetid&&a.context.dataset.metas.description?!0:!1};var e=a.$watch("context",function(b){b&&b.dataset&&(setTimeout(function(){a.renderContent(c)},0),a.expanded=!1,a.datasetUrl=a.context.domainUrl+"/explore/dataset/"+a.context.dataset.datasetid+"/",a.websiteName||(a.websiteName=a.context.domainUrl),e())},!0)}]}})}(),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsDatasetContext",["ODSAPI",function(a){var b=function(b,c,d,e,f,g,h){var i;if(g)i=g;else if(h){var j=d.$watch(h,function(a){a&&(d[e].parameters=a.parameters,j())});i=null}else i={};d[e]={name:e,type:"dataset",domain:b,domainUrl:a.getDomainURL(b),apikey:f,dataset:null,parameters:i},a.datasets.get(d[e],c,{extrametas:!0}).success(function(a){d[e].dataset=a})};return{restrict:"AE",scope:!0,replace:!0,link:function(a,c,d){for(var e=d.context.split(","),f=0;f<e.length;f++){var g=e[f].trim(),h=d[g+"Dataset"],i=d[g+"Domain"];h||console.log("ERROR : Context "+g+" : Missing dataset parameter");var j=d[g+"Apikey"],k=a.$eval(d[g+"Parameters"]),l=d[g+"ParametersFromContext"];b(i,h,a,g,j,k,l)}}}}])}(),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsDisqus",["ODSWidgetsConfig","$location","$window",function(a,b,c){return{restrict:"E",replace:!0,scope:{shortname:"@",identifier:"@"},template:'<div id="disqus_thread" class="odswidget"></div>',link:function(d){c.disqus_shortname=d.shortname||a.disqusShortname,d.identifier&&(c.disqus_identifier=d.identifier),c.disqus_url=b.absUrl(),c.disqus_config=function(){this.language=a.language};var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+c.disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}}}])}(),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsDomainStatistics",["ODSAPI",function(a){return{restrict:"AE",scope:!0,controller:function(b,c){var d=function(a,b,c){return c.name===b?(a.stats[b]=c.facets.length,!0):!1},e=b.$watch(c.context,function(b){b.stats={dataset:0,keyword:0,publisher:0,theme:0},a.datasets.search(b,{facet:["keyword","publisher","theme"]}).success(function(a){if(b.stats.dataset=a.nhits,a.facet_groups)for(var c=0;c<a.facet_groups.length;c++)d(b,"keyword",a.facet_groups[c])||d(b,"publisher",a.facet_groups[c])||!d(b,"theme",a.facet_groups[c])}),e()},!0)}}}])}(),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsFacetEnumerator",["ODSAPI",function(a){return{restrict:"E",replace:!0,transclude:!0,scope:{context:"=",facetName:"@"},template:'<div class="odswidget odswidget-facet-enumerator"><div class="no-data" ng-hide="items" translate>No data available yet</div><div ng-repeat="item in items" inject class="item"></div></div>',controller:function(b){var c=b.$watch("context",function(d){var e;if("catalog"===d.type)e=a.datasets.facets(d,b.facetName);else{if("dataset"!==d.type||!d.dataset)return;e=a.records.search(b.context,{rows:0,facet:b.facetName})}e.success(function(a){b.items=a.facet_groups?a.facet_groups[0].facets:[]}),c()},!0)}}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsGeotooltip",["$timeout","ModuleLazyLoader",function(a,b){var c=angular.element('<div id="odswidget-geotooltip" class="odswidget" style="opacity: 0; transition: opacity 200ms ease-out; position: fixed; z-index: 40000; visibility: hidden;"></div>'),d=null,e=null,f=function(a,b,f,g,h){var i=!1;(b!==c.css("width")||f!==c.css("height"))&&(i=!0),c.css("width",b),c.css("height",f);var j=jQuery(window).height()-(a.offset().top-jQuery(document).scrollTop());c.height()<j?c.css("top",a.height()+a.offset().top-jQuery(document).scrollTop()+5+"px"):c.css("top",a.offset().top-jQuery(document).scrollTop()-5-c.height()+"px");var k=jQuery(window).width()-(a.offset().left-jQuery(document).scrollLeft());if(c.width()<k?c.css("left",a.offset().left-jQuery(document).scrollLeft()+"px"):c.css("left",a.offset().left-jQuery(document).scrollLeft()-c.width()+"px"),a.after(c),null===d){d=new L.map(c[0],{zoomControl:!1});var l=new L.TileLayer("http://otile{s}.mqcdn.com/tiles/1.0.0/map/{z}/{x}/{y}.png",{minZoom:1,maxZoom:16,attribution:'Tiles <a href="http://www.mapquest.com/" target="_blank">MapQuest</a> <img src="http://developer.mapquest.com/content/osm/mq_logo.png"> - Map data  <a href="http://www.openstreetmap.org/" target="_blank">OpenStreetMap</a>',subdomains:"1234"});d.addLayer(l)}else i&&d.invalidateSize();null!==e&&d.removeLayer(e),e=L.layerGroup();var m=new L.LatLngBounds;if(g){angular.isString(g)&&(g=g.split(","));var n=new L.LatLng(g[0],g[1]),o=L.marker(n);e.addLayer(o),m.extend(n)}if(h){angular.isString(h)&&(h=angular.fromJson(h));var p=L.geoJson(h);e.addLayer(p),m.extend(p.getBounds())}e.addTo(d),d.fitBounds(m,{reset:!0}),c.css("opacity","1"),c.css("visibility","visible")},g=function(){c.css("opacity","0"),a(function(){c.css("visibility","hidden")},200)};return{template:'<span ng-transclude style="border-bottom: 1px dotted #000000; cursor: help;" class="geotooltip"></span>',replace:!0,restrict:"E",transclude:!0,scope:{coords:"=",width:"@",height:"@",delay:"@",geojson:"="},link:function(c,d,e){b("leaflet").then(function(){var b=(e.width||200)+"px",h=(e.height||200)+"px",i=null,j=e.delay||500;d.bind("mouseenter",function(){0===j?f(d,b,h,c.coords,c.geojson):i=a(function(){f(d,b,h,c.coords,c.geojson),i=null},j)}),d.bind("click",function(){f(d,b,h,c.coords,c.geojson),null!==i&&(a.cancel(i),i=null)}),d.bind("mouseleave",function(){g(),null!==i&&(a.cancel(i),i=null)})})}}}])}(),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsChart",["ODSAPI","$q","translate","ModuleLazyLoader",function(a,b,c,d){return{restrict:"A",replace:!0,scope:{parameters:"=odsChart",domain:"=",apikey:"="},template:'<div class="ods-chart"><div class="no-data" ng-hide="data" translate>No data available yet</div><div class="chartplaceholder"></div><debug data="chartoptions"></debug></div>',link:function(e,f){var g=f.find(".chartplaceholder");d("highcharts").then(function(){function d(a){if(!i){if(angular.isObject(a)&&("day"in a||"month"in a||"year"in a)){var b=new Date(a.year,a.month-1||0,a.day||1,a.hour||0,a.minute||0);return Highcharts.dateFormat("%Y-%m-%d",b)}return a}switch(console.warn("formatRowX on periodic value should not be used anymore"),i){case"month":return[c("Jan"),c("Feb"),c("Mar"),c("Apr"),c("May"),c("Jun"),c("Jul"),c("Aug"),c("Sep"),c("Oct"),c("Nov"),c("Dec")][a.month-1];case"weekday":return[c("Monday"),c("Tuesday"),c("Wednesday"),c("Thursday"),c("Friday"),c("Saturday"),c("Sunday")][a.weekday];case"day":return a.day;default:return a}}Highcharts.setOptions({global:{useUTC:!1},plotOptions:{pie:{tooltip:{pointFormat:"{series.name}: <b>{point.y} ({point.percentage:.1f}%)</b>"}}}});var f,h,i;e.$watch("parameters",function(c){if(f=void 0,h=void 0,i=void 0,c&&c.queries&&c.queries.length){var j={chart:{},title:{text:""},credits:{enabled:!1},colors:[],series:[],xAxis:{title:{text:e.parameters.xLabel||e.parameters.queries[0].xAxis},labels:{rotation:-45,align:"right"},minPadding:0,maxPadding:0},yAxis:[],plotOptions:{columnrange:{pointPadding:0,groupPadding:0,borderWidth:0}},tooltip:{valueDecimals:2,formatter:function(a){var b,c=this.points||angular.isArray(this)?this:[this],d=c[0].series;return b=[d.tooltipHeaderFormatter(c[0])],angular.forEach(c,function(a){d=a.series;var c=d.tooltipFormatter&&d.tooltipFormatter(a)||a.point.tooltipFormatter(d.tooltipOptions.pointFormat);c=c.replace(/(\.|,)00</,"<"),b.push(c)}),b.push(a.options.footerFormat||""),b.join("")}}};if(e.chartoptions=j,e.parameters.timescale&&0===$.grep(e.parameters.queries,function(a){return a.sort}).length){f=e.parameters.timescale;var k=f.split(" ");h=k[0],i=2==k.length?k[1]:""}h?(j.xAxis.type="datetime",j.xAxis.maxZoom=36e5,j.chart.zoomType="xy"):j.xAxis.categories=[];var l={},m=[];e.parameters.singleAxis&&j.yAxis.push({title:{text:e.parameters.singleAxisLabel||""},type:e.parameters.singleAxisScale||"linear"}),angular.forEach(e.parameters.queries,function(b){var c={dataset:b.config.dataset,x:b.xAxis,sort:b.sort||"",maxpoints:b.maxpoints||""};if(f&&(c.precision=h,c.periodic=i),b.timescale){var d=b.timescale.split(" ");c.precision=d[0],c.periodic=2==d.length?d[1]:""}l[b.config.dataset]={},angular.forEach(b.charts,function(a,d){["arearange","areasplinerange","columnrange"].indexOf(a.type)>=0?(a.func="COUNT",a.charts||(a.charts=[{func:"MIN",expr:a.yAxis},{func:"MAX",expr:a.yAxis}]),"QUANTILES"!==a.charts[0].func||a.charts[0].subsets||(a.charts[0].subsets=5),"QUANTILES"!==a.charts[1].func||a.charts[1].subsets||(a.charts[1].subsets=95),$.each(a.charts[0],function(a,b){c["y.serie"+(d+1)+"min."+a]=b}),$.each(a.charts[1],function(a,b){c["y.serie"+(d+1)+"max."+a]=b}),b.sort==="serie"+(d+1)&&(c.sort="")):(a.charts&&delete a.charts,c["y.serie"+(d+1)+".expr"]=a.yAxis,c["y.serie"+(d+1)+".func"]=a.func,c["y.serie"+(d+1)+".cumulative"]=a.cumulative||!1,"QUANTILES"===a.func&&(a.subsets||(a.subsets=50),c["y.serie"+(d+1)+".subsets"]=a.subsets)),!e.parameters.singleAxis&&angular.isUndefined(l[b.config.dataset][a.yAxis])&&(l[b.config.dataset][a.yAxis]=j.yAxis.push({title:{text:a.yLabel,style:{color:a.color}},labels:{style:{color:a.color}},type:a.scale||"linear",opposite:!!j.yAxis.length})-1),j.series.push($.extend({},{name:a.yLabel,color:a.color,type:a.type,yAxis:e.parameters.singleAxis?0:l[b.config.dataset][a.yAxis],marker:{enabled:!1},shadow:!1,tooltip:{},data:[]},a.extras)),"bar"==a.type&&(j.xAxis.labels.rotation=0),j.colors.push(a.color)});var g={domain:e.domain,domainUrl:a.getDomainURL(e.domain),dataset:{datasetid:c.dataset},apikey:e.apikey,parameters:{}};m.push(a.records.analyze(g,angular.extend({},b.config.options,c)))}),e.data=!1,b.all(m).then(function(a){function b(a,b){return b.subsets?a[b.subsets+".0"]:a}var c,f=0;h&&angular.forEach(a,function(a,b){for(var d=(e.parameters.queries[b].charts.length,0);d<a.data.length;d++){e.data=!0;var f=a.data[d];if(f.x.year){var g=new Date(f.x.year,f.x.month-1||0,f.x.day||1,f.x.hour||0,f.x.minute||0);g.setFullYear(f.x.year),(void 0===c||c>g)&&(c=g)}}}),angular.forEach(a,function(a,g){for(var i=e.parameters.queries[g].charts.length,k=0;k<a.data.length;k++){e.data=!0;for(var l=a.data[k],m=0;i>m;m++){var n=e.parameters.queries[g].charts[m];if(h){j.series[f+m].pointPadding=0,j.series[f+m].groupPadding=0,j.series[f+m].borderWidth=0;var o;if(o=new Date(l.x.year||2e3,l.x.month-1||0,l.x.day||1,l.x.hour||0,l.x.minute||0),o.setFullYear(l.x.year||2e3),"year"in l.x){var p="";"day"in l.x&&(p+=" %e"),"month"in l.x&&(p+=" %B"),p+=" %Y","hour"in l.x&&(p+="minute"in l.x?" %Hh%M":" %Hh"),j.series[f+m].tooltip.xDateFormat=p}else c&&o.setYear(c.getFullYear()),"month"in l.x&&(j.series[f+m].tooltip.xDateFormat="%B"),"day"in l.x&&(j.series[f+m].tooltip.xDateFormat="month"in l.x?"%e %B":"%e"),"weekday"in l.x&&(o.setDate(o.getDate()-(o.getDay()-1)+l.x.weekday),j.series[f+m].tooltip.xDateFormat="%a"),"hour"in l.x&&(j.series[f+m].tooltip.xDateFormat="%Hh");"month"in l.x&&(j.series[f+m].pointRange=26352e5),"day"in l.x?(29==l.x.day&&2==l.x.month&&(o.setDate(28),o.setMonth(1)),j.series[f+m].pointRange=864e5):"month"in l.x&&o.setDate(16),"weekday"in l.x&&(j.series[f+m].pointRange=864e5),"hour"in l.x&&(j.series[f+m].pointRange=36e5),j.series[f+m].data.push(["arearange","areasplinerange","columnrange"].indexOf(j.series[f+m].type)>=0?[o.getTime(),b(l["serie"+(m+1)+"min"],n.charts[0]),b(l["serie"+(m+1)+"max"],n.charts[1])]:[o.getTime(),b(l["serie"+(m+1)],n)])}else j.series[f+m].data.push("pie"==j.series[f+m].type?[d(l.x),b(l["serie"+(m+1)],n)]:["arearange","areasplinerange","columnrange"].indexOf(j.series[f+m].type)>=0?[b(l["serie"+(m+1)+"min"],n.charts[0]),b(l["serie"+(m+1)+"max"],n.charts[1])]:b(l["serie"+(m+1)],n))}h||j.xAxis.categories.push(d(l.x))}f+=i});try{g.css("height",g.height()),e.chart=g.highcharts(j),g.css("height","")}catch(i){0===i.indexOf("Highcharts error #19")&&angular.forEach(e.parameters.queries,function(a){a.maxpoints=20})}})}},!0)})}}}]),a.directive("odsHighcharts",function(){var a=["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"];return{restrict:"E",scope:{context:"=",fieldX:"@",expressionY:"@",functionY:"@",timescale:"@",chartType:"@",color:"@",chartConfig:"=",labelX:"@",labelY:"@",sort:"@",maxpoints:"@"},replace:!0,template:'<div class="odswidget odswidget-highcharts"><div ods-chart="chart" domain="context.domain" apikey="context.apikey"></div></div>',controller:["$scope","ODSWidgetsConfig",function(b,c){var d=c.chartColors||a;b.color&&(d=b.color.split(",").map(function(a){return a.trim()}));var e=b.$watch("context.dataset",function(a){if(a){if("dataset"!==b.context.type&&console.error("ods-highcharts requires a Dataset Context"),angular.isUndefined(b.chartConfig)){var c={};"pie"===b.chartType&&(c={colors:d});var f="";f="y"===b.sort?"serie1":"-y"===b.sort?"-serie1":b.sort,b.chart={timescale:b.timescale,xLabel:b.labelX,queries:[{config:{dataset:b.context.dataset.datasetid,options:b.context.parameters},xAxis:b.fieldX,sort:f,maxpoints:b.maxpoints||50,charts:[{yAxis:b.expressionY,yLabel:b.labelY,func:b.functionY,color:d[0],type:b.chartType,extras:c}]}]}}else b.chart=angular.isString(b.chartConfig)?JSON.parse(atob(b.chartConfig)):b.chartConfig;e()}})}]}}),a.directive("odsMultiHighcharts",function(){return{restrict:"E",scope:{context:"=",chartConfig:"="},replace:!0,template:'<div class="odswidget odswidget-multihighcharts"><div ods-chart="chart" domain="context.domain" apikey="context.apikey"></div></div>',controller:["$scope",function(a){var b=a.$watch("context",function(c){c&&("catalog"!==c.type&&console.error("ods-multi-highcharts requires a Catalog Context"),a.chart=angular.isString(a.chartConfig)?JSON.parse(atob(a.chartConfig)):a.chartConfig,b())})}]}})}(),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsLastDatasetsFeed",["ODSAPI",function(a){return{restrict:"E",replace:!0,template:'<div class="odswidget odswidget-last-datasets-feed"><ul>   <li class="no-data" ng-hide="datasets" translate>No data available yet</li>   <li ng-repeat="dataset in datasets" ng-if="datasets">       <ods-theme-picto theme="{{dataset.metas.theme}}"></ods-theme-picto>       <div class="dataset-details">           <div class="title"><a ng-href="{{context.domainUrl}}/explore/dataset/{{dataset.datasetid}}/" target="_self">{{ dataset.metas.title }}</a></div>           <div class="modified"><i class="icon-calendar"></i> <span title="{{ dataset.metas.modified|moment:\'LLL\' }}"><translate>Modified</translate> {{ dataset.metas.modified|timesince }}</span></div>       </div>   </li></ul></div>',scope:{context:"="},controller:["$scope",function(b){var c=function(){a.datasets.search(b.context,{rows:5,sort:"modified"}).success(function(a){b.datasets=a.datasets})};b.$watch("context",function(){c()})}]}}])}(),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsLastReusesFeed",["ODSAPI",function(a){return{restrict:"E",replace:!0,template:'<div class="odswidget odswidget-last-reuses-feed"><ul>   <li class="no-data" ng-hide="reuses" translate>No data available yet</li>   <li ng-repeat="reuse in reuses" ng-if="reuses">       <div class="reuse-thumbnail">           <span style="display: inline-block; height: 100%; vertical-align: middle;"></span>           <a ng-href="{{context.domainUrl}}/explore/dataset/{{reuse.dataset.id}}/" target="_self"><img ng-if="reuse.thumbnail" ng-src="{{ reuse.thumbnail }}"></a>       </div>       <div class="reuse-details">           <div class="title"><a ng-href="{{context.domainUrl}}/explore/dataset/{{reuse.dataset.id}}/" target="_self">{{ reuse.title }}</a></div>           <div class="dataset"><a ng-href="{{context.domainUrl}}/explore/dataset/{{reuse.dataset.id}}/" target="_self">{{ reuse.dataset.title }}</a></div>           <div class="modified"><span title="{{ reuse.created_at|moment:\'LLL\' }}"><i class="icon-calendar"></i> {{ reuse.created_at|timesince }}</span></div>       </div>   </li></ul></div>',scope:{context:"="},controller:["$scope",function(b){var c=function(){a.reuses(b.context,{rows:5,sort:"modified"}).success(function(a){b.reuses=a})};b.$watch("context",function(){c()})}]}}])}(),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsMap",["ModuleLazyLoader",function(a){return{restrict:"E",scope:{context:"=",embedMode:"@",autoResize:"@",mapContext:"=?",location:"@",basemap:"@",isStatic:"@",showFilters:"@"},replace:!0,template:function(a){return a.children().wrapAll("<div>"),a.data("tooltip-template",a.children().html()),'<div class="odswidget odswidget-map"><div class="map"></div><div class="overlay map opaque-overlay" ng-show="pendingRequests.length && initialLoading"><spinner class="spinner"></spinner></div></div>'},link:function(b,c){function d(){$(".odswidget-map > .map").length>0&&$(".odswidget-map > .map").height(Math.max(200,$(window).height()-$(".odswidget-map > .map").offset().top))}angular.isUndefined(b.mapContext)&&(b.mapContext={},b.location&&(b.mapContext.location=b.location),b.basemap&&(b.mapContext.basemap=b.basemap)),"true"===b.autoResize&&($(window).on("resize",d),d()),a("leaflet").then(function(){L.Control.FilterByView=L.Control.extend({options:{position:"topright"},onAdd:function(){var a="leaflet-control-filterview",c=a+" leaflet-bar leaflet-control",d=L.DomUtil.create("div",c),e=L.DomUtil.create("a","leaflet-bar-part",d);return e.href="#",b.mapViewFilter&&(d.className=c+" active"),L.DomEvent.on(e,"click",L.DomEvent.stopPropagation).on(e,"click",L.DomEvent.preventDefault).on(e,"click",function(){return b.$apply(function(a){a.mapViewFilter=!a.mapViewFilter}),d.className=b.mapViewFilter?c+" active":c,!1}).on(e,"dblclick",L.DomEvent.stopPropagation),b.$watch("mapViewFilter",function(a,b){a!==b&&(d.className=a?c+" active":c)}),d}}),b.initMap=function(a,d,e,f,g,h,i,j){var k={basemapsList:e,worldCopyJump:!0,minZoom:2,basemap:h,dragging:!i,zoomControl:!i,prependAttribution:j};i&&(k.doubleClickZoom=!1,k.scrollWheelZoom=!1);var l=new L.ODSMap(c.children()[0],k);l.addControl(new L.Control.Scale),"true"!==d&&("true"===b.showFilters&&l.addControl(new L.Control.FilterByView),l.addControl(new L.Control.Fullscreen)),g&&!i&&l.addControl(new L.Control.GeoBox({placeholder:f("Find a place...")})),i||l.addControl(new L.Control.Locate({maxZoom:18})),l.on("popupclose",function(a){jQuery(a.popup.getContent()).trigger("popupclose")}),b.map=l}})},controller:["$scope","$http","$compile","$q","$filter","$element","translate","ODSAPI","DebugLogger","ODSWidgetsConfig",function(a,b,c,d,e,f,g,h,i,j){i.log("init map"),a.pendingRequests=b.pendingRequests,a.initialLoading=!0;var k=null,l=null,m={delimiter:",",accuracy:5,formatLatLng:function(a){var b=L.Util.formatNum(a.lat,this.accuracy),c=L.Util.formatNum(a.lng,this.accuracy);return new L.latLng(b,c)},getLocationParameterAsArray:function(a){return a.split(this.delimiter)},getLocationParameterFromMap:function(a){var b=this.formatLatLng(a.getCenter());return a.getZoom()+this.delimiter+b.lat+this.delimiter+b.lng},getCenterFromLocationParameter:function(a){var b=this.getLocationParameterAsArray(a);return new L.latLng(b[1],b[2])},getZoomFromLocationParameter:function(a){return this.getLocationParameterAsArray(a)[0]}},n=function(b,d,e){var g=a.$new(!1);e?g.recordid=e:g.shape=d;var h={offset:[0,-30],maxWidth:250,minWidth:250,autoPanPaddingTopLeft:[50,305],autoPan:!a.mapViewFilter&&!a.staticMap},i=f.data("tooltip-template");(angular.isUndefined(i)||!angular.isString(i)||""===i.trim())&&(i="",g.template=a.context.dataset.extra_metas&&a.context.dataset.extra_metas.visualization&&a.context.dataset.extra_metas.visualization.map_tooltip_template||j.basePath+"templates/geoscroller_tooltip.html");var k=new L.Popup(h).setLatLng(b).setContent(c('<geo-scroller shape="shape" context="context" recordid="recordid" map="map" template="{{ template }}">'+i+"</geo-scroller>")(g)[0]);k.openOn(a.map)},o=function(a){return a=Math.round(100*a)/100,a=e("number")(a)},p=function(b){return function(c,d){if(c.count>1){var e=new L.ClusterMarker(c.cluster_center,{geojson:c.cluster,value:c.count,total:d,numberFormattingFunction:o,color:a.markerColor});a.staticMap||e.on("click",function(){a.map.getZoom()===a.map.getMaxZoom()?n(marker.getLatLng(),c.cluster):a.$apply(function(){if("Point"===c.cluster.type)a.map.fitBounds([[c.cluster.coordinates[1],c.cluster.coordinates[0]],[c.cluster.coordinates[1],c.cluster.coordinates[0]]]);else{var b={};jQuery.extend(b,a.staticSearchOptions,a.context.parameters,{"geofilter.polygon":ODS.GeoFilter.getGeoJSONPolygonAsPolygonParameter(c.cluster)}),h.records.boundingbox(a.context,b).success(function(b){a.map.fitBounds([[b.bbox[1],b.bbox[0]],[b.bbox[3],b.bbox[2]]])})}})}),b.addLayer(e)}else{var f=l(c.cluster_center);f.on("click",function(a){n(a.target.getLatLng(),c.cluster)}),b.addLayer(f)}}},q=function(){var b={"geofilter.polygon":ODS.GeoFilter.getBoundsAsPolygonParameter(a.map.getBounds()),clusterprecision:a.map.getZoom(),clusterdistance:50};jQuery.extend(b,a.staticSearchOptions,a.context.parameters),a.currentClusterRequestCanceler&&a.currentClusterRequestCanceler.resolve(),a.currentClusterRequestCanceler=d.defer(),h.records.geo(a.context,b,a.currentClusterRequestCanceler.promise).success(function(b){var c=b.clusters;a.records=c.length;for(var d=new L.LayerGroup,e=p(d),f=0;f<c.length;f++){var g=c[f];e(g,b.count.max)}d.addTo(a.map),a.layerGroup&&a.map.removeLayer(a.layerGroup),a.layerGroup=d,a.initialLoading=!1,a.currentClusterRequestCanceler=null})},r=function(){var b={"geofilter.polygon":ODS.GeoFilter.getBoundsAsPolygonParameter(a.map.getBounds()),clusterprecision:a.map.getZoom()};jQuery.extend(b,a.staticSearchOptions,a.context.parameters),b.rows=1e3,a.currentClusterRequestCanceler&&a.currentClusterRequestCanceler.resolve(),a.currentClusterRequestCanceler=d.defer(),h.records.geopreview(a.context,b,a.currentClusterRequestCanceler.promise).success(function(b){for(var c=new L.LayerGroup,d=0;d<b.length;d++)s(c,b[d]);c.addTo(a.map),a.layerGroup&&a.map.removeLayer(a.layerGroup),a.layerGroup=c,a.initialLoading=!1,a.currentClusterRequestCanceler=null})},s=function(a,b){var c={radius:3,fillColor:"#0033ff",color:"#0000ff",weight:1,opacity:1,fillOpacity:.5},d=new L.GeoJSON(b.geometry,{pointToLayer:function(a,b){return L.circleMarker(b,c)}});a.addLayer(d),d.on("click",function(a){n(a.latlng,null,b.id)})},t=function(){var b={};b["geofilter.polygon"]=ODS.GeoFilter.getBoundsAsPolygonParameter(a.map.getBounds()),jQuery.extend(b,a.staticSearchOptions,a.context.parameters),i.log("map -> download"),h.records.download(a.context,b).success(function(b){a.records=b,a.error="",a.nhits=b.length;for(var c=new L.LayerGroup,d=new L.LatLngBounds,e=new L.FeatureGroup,f=0;f<b.length;f++){var g=b[f];u(g,c,d,e)}a.layerGroup&&a.map.removeLayer(a.layerGroup),c.addLayer(e),c.addTo(a.map),a.layerGroup=c,a.initialLoading=!1}).error(function(b){a.error=b.error,a.initialLoading=!1})},u=function(a,b,c,d){var e;if(k){if(!a.fields[k])return;e=a.fields[k],"Point"===e.type&&angular.isDefined(a.geometry)&&(e=a.geometry)}else{if(!a.geometry)return;e=a.geometry}if("Point"==e.type){var f=new L.LatLng(e.coordinates[1],e.coordinates[0]),g=l(f);g.on("click",function(a){n(a.target.getLatLng(),e)}),d.addLayer(g),c.extend(f)}else{var h=new L.GeoJSON(e);h.on("click",function(){n(L.latLng(a.geometry.coordinates[1],a.geometry.coordinates[0]),a.geometry)}),b.addLayer(h),c.extend(h.getBounds())}};a.$watch("context.parameters",function(b,c){return b===c||a.initialLoading?void 0:(i.log("map -> searchOptions watch -> refresh records"),!b["geofilter.polygon"]&&c["geofilter.polygon"]?void(a.mapViewFilter=!1):!c["geofilter.polygon"]&&b["geofilter.polygon"]?void(a.mapViewFilter=!0):void v(a.mapViewFilter?!1:!0))},!0),a.$watch("mapContext.location",function(){a.map&&v(!1)},!0);var v=function(b){var c=200,d=5e5,e={};b||(e["geofilter.polygon"]=ODS.GeoFilter.getBoundsAsPolygonParameter(a.map.getBounds())),jQuery.extend(e,a.staticSearchOptions,a.context.parameters),h.records.boundingbox(a.context,e).success(function(e){if(b)if(e.bbox.length>0){var f=a.map.getBounds();a.map.fitBounds([[e.bbox[1],e.bbox[0]],[e.bbox[3],e.bbox[2]]]);var g=a.map.getBounds();angular.equals(f,g)&&t()}else t();else e.count<c||a.map.getZoom()===a.map.getMaxZoom()?t():e.count<d?e.geometries.Point&&e.geometries.Point>e.count/2?q():r():q()})},w=function(b){var c=b.getSize();c.x>0&&c.y>0&&(a.mapContext.location=m.getLocationParameterFromMap(b),a.mapViewFilter&&(a.context.parameters["geofilter.polygon"]=ODS.GeoFilter.getBoundsAsPolygonParameter(b.getBounds())))},x=a.$watch("context.dataset",function(b){if(b&&b.datasetid){a.mapViewFilter=a.context.parameters["geofilter.polygon"]?!0:!1,a.staticMap="true"===a.isStatic||"true"===a.context.parameters.static;var c=a.$watch("initMap",function(){a.initMap&&(c(),a.initMap(b,a.embedMode,j.basemaps,g,j.mapGeobox,a.mapContext.basemap,a.staticMap,j.mapPrependAttribution))});x(),a.staticSearchOptions={rows:a.recordLimit,dataset:a.context.dataset.datasetid,format:"json"};for(var e=0;e<b.fields.length;e++){var f=b.fields[e];if("geo_shape"===f.type){k=f.name;break}}var n={};b.extra_metas&&b.extra_metas.visualization&&(n=b.extra_metas.visualization),a.markerColor=n.map_marker_color||"#29398C",l=function(b){return new L.VectorMarker(b,{color:a.markerColor,icon:n.map_marker_picto||"icon-circle",marker:!n.map_marker_hidemarkershape})},i.log("map -> dataset watch -> refresh records");var o=a.$watch("map",function(b){if(b){a.$watch("mapViewFilter",function(b,c){b!==c&&(b?a.context.parameters["geofilter.polygon"]=ODS.GeoFilter.getBoundsAsPolygonParameter(a.map.getBounds()):a.context.parameters["geofilter.polygon"]&&delete a.context.parameters["geofilter.polygon"])});var c=function(){var b=d.defer();if(a.context.parameters.mapviewport)"("===a.context.parameters.mapviewport.substring(0,1)&&(a.context.parameters.mapviewport=ODS.GeoFilter.getBoundsAsBboxParameter(ODS.GeoFilter.getPolygonParameterAsBounds(a.context.parameters.mapviewport))),b.resolve(ODS.GeoFilter.getBboxParameterAsBounds(a.context.parameters.mapviewport));else if(a.context.parameters["geofilter.polygon"])b.resolve(ODS.GeoFilter.getPolygonParameterAsBounds(a.context.parameters["geofilter.polygon"]));else{var c={};jQuery.extend(c,a.staticSearchOptions,a.context.parameters),h.records.boundingbox(a.context,c).success(function(a){b.resolve(a.count>0?[[a.bbox[1],a.bbox[0]],[a.bbox[3],a.bbox[2]]]:[[-60,-180],[80,180]])})}return b.promise},e=function(){var e=d.defer();if(a.mapContext.location){i.log("Location found");var f=m.getCenterFromLocationParameter(a.mapContext.location),g=m.getZoomFromLocationParameter(a.mapContext.location);i.log(f,g),b.setView(f,g),e.resolve()}else i.log("Use boundsRetrieval"),c(a.context.dataset).then(function(c){a.context.parameters.mapviewport&&(i.log("Deleted mapviewport"),delete a.context.parameters.mapviewport),i.log(c),b.fitBounds(c),e.resolve()});return e.promise};e().then(function(){i.log("First onViewportMove"),w(a.map),v(!1),a.map.on("moveend",function(b){w(b.target),a.$$phase||a.$root.$$phase||a.$apply()})}),j.basemaps.length>1&&a.map.on("baselayerchange",function(b){a.mapContext.basemap=b.layer.basemapId,a.$$phase||a.$root.$$phase||a.$apply()}),o()}})}},!0)}]}}]),a.directive("geoScroller",function(){return{restrict:"E",transclude:!0,template:'<div class="odswidget-geo-scroller"><spinner ng-hide="records"></spinner><h2 ng-show="records.length > 1" class="scroller-control ng-leaflet-tooltip-cloak"><i class="icon-chevron-left" ng-click="moveIndex(-1)"></i><span ng-bind="(selectedIndex+1)+\'/\'+records.length" ng-click="moveIndex(1)"></span><i class="icon-chevron-right" ng-click="moveIndex(1)"></i></h2><div class="ng-leaflet-tooltip-cloak limited-results" ng-show="records && records.length == RECORD_LIMIT" translate>(limited to the first {{RECORD_LIMIT}} records)</div><div ng-if="template" ng-include src="safeUrl(template)"></div><div inject></div></div>',scope:{shape:"=",context:"=",recordid:"=",map:"=",template:"@"},replace:!0,link:function(a,b){b.bind("popupclose",function(){a.$destroy()
}),a.unCloak=function(){jQuery(".ng-leaflet-tooltip-cloak",b).removeClass("ng-leaflet-tooltip-cloak")}},controller:["$scope","$filter","ODSAPI","ODSWidgetsConfig","$sce",function(a,b,c,d,e){a.RECORD_LIMIT=100,a.records=[],a.selectedIndex=0,a.moveIndex=function(b){var c=(a.selectedIndex+b)%a.records.length;0>c&&(c=a.records.length+c),a.selectedIndex=c},a.safeUrl=function(a){return a===d.basePath+"templates/geoscroller_tooltip.html"?e.trustAsResourceUrl(a):a};var f={format:"json",rows:a.RECORD_LIMIT};if(a.recordid)f.q="recordid:'"+a.recordid+"'";else if(angular.isArray(a.shape))f["geofilter.distance"]=a.shape[0]+","+a.shape[1];else if("Point"===a.shape.type)f["geofilter.distance"]=a.shape.coordinates[1]+","+a.shape.coordinates[0];else{for(var g=a.shape.coordinates[0],h=[],i=0;i<g.length;i++){var j=angular.copy(g[i]);j.length>2&&j.splice(2,1),j.reverse(),h.push(j.join(","))}var k="("+h.join("),(")+")";f["geofilter.polygon"]=k}var l=function(){var b={};angular.extend(b,a.context.parameters,f),c.records.download(a.context,b).success(function(b){b.length>0?(a.selectedIndex=0,a.records=b,a.unCloak()):a.map.closePopup()})};a.$watch("searchOptions",function(){l()}),a.$apply(),a.getTitle=function(b){if(a.context.dataset.extra_metas&&a.context.dataset.extra_metas.visualization&&a.context.dataset.extra_metas.visualization.map_tooltip_title){var c=a.context.dataset.extra_metas.visualization.map_tooltip_title;if(angular.isDefined(b.fields[c])&&""!==b.fields[c])return b.fields[c]}return null}}]}})}(),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsMostPopularDatasets",["ODSAPI",function(a){return{restrict:"E",replace:!0,template:'<div class="odswidget odswidget-most-popular-datasets"><ul>   <li class="no-data" ng-hide="datasets" translate>No data available yet</li>   <li ng-repeat="dataset in datasets" ng-if="datasets">       <ods-theme-picto theme="{{dataset.metas.theme}}"></ods-theme-picto>       <div class="dataset-details">           <div class="title"><a ng-href="{{context.domainUrl}}/explore/dataset/{{dataset.datasetid}}/" target="_self">{{ dataset.metas.title }}</a></div>           <div class="count"><i class="icon-download-alt"></i> {{ dataset.extra_metas.explore.download_count }} '+"<ng-pluralize count=\"dataset.extra_metas.explore.download_count\" translate=\"when\" when=\"{'0': 'download', '1': 'download', 'other': 'downloads'}\"></ng-pluralize></div>       </div>   </li></ul></div>",scope:{context:"="},controller:["$scope",function(b){var c=function(){a.datasets.search(b.context,{rows:5,sort:"explore.download_count",extrametas:!0}).success(function(a){b.datasets=a.datasets})};b.$watch("context",function(){c()})}]}}])}(),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsMostUsedThemes",["ODSAPI",function(a){return{restrict:"E",replace:!0,template:'<div class="odswidget odswidget-most-used-themes"><ul>   <li class="no-data" ng-hide="themes" translate>No data available yet</li>   <li ng-repeat="theme in themes" ng-if="themes">       <div class="dataset-details">           <div class="name"><a ng-href="{{ context.domainUrl }}/explore/?refine.theme={{ theme.path }}" target="_self">{{ theme.name }}</a></div>           <div class="count"><i class="icon-table"></i> <translate>Used by</translate> {{ theme.count }} '+"<ng-pluralize count=\"theme.count\" translate=\"when\" when=\"{'0': 'dataset', '1': 'dataset', 'other': 'datasets'}\"></ng-pluralize></div>       </div>   </li></ul></div>",scope:{context:"="},controller:["$scope",function(b){var c=function(){a.datasets.facets(b.context,"theme").success(function(a){a.facet_groups&&(b.themes=a.facet_groups[0].facets.slice(0,5))})};b.$watch("context",function(){c()})}]}}])}(),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsResultEnumerator",["ODSAPI",function(a){return{restrict:"E",replace:!0,transclude:!0,scope:{context:"=",max:"@?"},template:'<div class="odswidget odswidget-result-enumerator"><div ng-if="!count" class="no-results" translate>No results</div><div ng-if="count" class="results-count">{{count}} <translate>results</translate></div><div ng-repeat="item in items" inject class="item"></div></div>',controller:["$scope",function(b){var c=b.max||10;b.$watch("context",function(d){var e=angular.extend({},d.parameters,{rows:c});if("catalog"===d.type)a.datasets.search(d,e).success(function(a){b.count=a.nhits,b.items=a.datasets});else{if("dataset"!==d.type||!d.dataset)return;a.records.search(d,e).success(function(a){b.count=a.nhits,b.items=a.records})}},!0)}]}}])}(),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsSearchbox",function(){return{restrict:"E",replace:!0,template:'<div class="odswidget odswidget-searchbox"><form method="GET" action="{{ actionUrl }}"><input class="searchbox" name="q" type="text" placeholder="{{placeholder}}"></form></div>',scope:{placeholder:"@",context:"="},controller:["$scope","$sce",function(a,b){a.actionUrl="/explore/";var c=a.$watch("context",function(d){d&&(a.actionUrl=b.trustAsResourceUrl(a.context.domainUrl+a.actionUrl),c())})}]}})}(),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsTable",["ODSWidgetsConfig","$sce",function(a,b){return{restrict:"E",scope:{context:"=",displayedFields:"@",tableContext:"=?",sort:"@"},replace:!0,transclude:!0,templateUrl:b.trustAsResourceUrl(a.basePath+"templates/table.html"),controller:["$scope","$element","$timeout","$document","$window","ODSAPI","DebugLogger","$filter","$http","$compile","$transclude",function(a,b,c,d,e,f,g,h,i,j,k){angular.isUndefined(a.tableContext)&&(a.tableContext={}),a.sort&&(a.tableContext.tablesort=a.sort),a.displayedFieldsArray=null,a.page=0,a.resultsPerPage=40,a.fetching=!1,a.records=[],a.working=!0,a.layout=[],a.done=!1;var l,m=b.find(".records-header"),n=b.find(".records-body tbody"),o=m.offset().left,p=0,q=0,r=!1,s=0,t=0,u=100,v=0,w=0,x=Math.random().toString(36).substring(7),y="table-"+x,z="stylesheet-"+x,A=function(b){a.fetching=!0;var c,d={};b?(a.done=!1,a.page=0,a.records=[],c=0):(a.page++,c=a.page*a.resultsPerPage),jQuery.extend(d,a.staticSearchOptions,a.context.parameters,{start:c}),a.tableContext.tablesort&&(d.sort=a.tableContext.tablesort),f.records.search(a.context,d).success(function(c){c.records.length||(a.working=!1),a.records=b?c.records:a.records.concat(c.records),a.nhits=c.nhits,a.error="",a.fetching=!1,a.done=(a.page+1)*a.resultsPerPage>=c.nhits}).error(function(b){a.error=b.error,a.fetching=!1})};a.loadMore=function(){a.fetching||a.done||!a.staticSearchOptions||A(!1)},a.isFieldSortable=function(a){return ODS.DatasetUtils.isFieldSortable(a)},a.toggleSort=function(b){if(a.isFieldSortable(b)){if(a.tableContext.tablesort==b.name)return void(a.tableContext.tablesort="-"+b.name);if(a.tableContext.tablesort=="-"+b.name)return void(a.tableContext.tablesort=b.name);a.tableContext.tablesort="-"+b.name}else delete a.tableContext.tablesort};var B=!1;k(function(a){B=a.length>0});var C=function(c,d,e){var f,g,i=d[c];if(f=document.createElement("tr"),f.className="record-"+c,"end"===e){var m=b.find(".placeholderBot")[0];m.parentNode.insertBefore(f,m)}else{var n=b.find(".placeholderTop")[0];n.parentNode.insertBefore(f,n.nextSibling)}g=document.createElement("td");var o=document.createElement("div");o.appendChild(document.createTextNode(c+1)),g.appendChild(o),f.appendChild(g);for(var p=0;p<l.length;p++){var q=l[p],r=h("formatFieldValue")(i.fields,q);g=document.createElement("td"),f.appendChild(g);var o=document.createElement("div");g.appendChild(o);var s,t;B?(s=a.$new(!0),s.record=i,s.currentField=q.name,s.currentValue=i.fields[q.name],s.currentFormattedValue=r,t=j("<div inject></div>",k)(s)[0]):(s=a.$new(!1),s.recordFields=i.fields[q.name],q&&"geo_point_2d"===q.type?(s.fieldValue=r,window.ie8?(t=document.createElement("span"),t.title=r,t.innerHTML=r):t=j('<ods-geotooltip width="300" height="300" coords="recordFields">'+r+"</ods-geotooltip>")(s)[0]):q&&"geo_shape"===q.type?(s.fieldValue=h("truncate")(r),window.ie8?(t=document.createElement("span"),t.title=r,t.innerHTML=r):t=j('<ods-geotooltip width="300" height="300" geojson="recordFields">'+r+"</ods-geotooltip>")(s)[0]):(t=document.createElement("span"),t.title=r,t.innerHTML=h("nofollow")(h("prettyText")(r)))),o.appendChild(t)}return f},D=function(a){var c=b[0].getElementsByClassName("record-"+a)[0];c&&c.parentNode.removeChild(c)},E=function(){var c=b.find(".records-body")[0].offsetHeight,d=b.find(".records-body")[0].scrollTop,e=n.find("tr").eq(1).height(),f=b.find(".placeholderTop")[0],g=b.find(".placeholderBot")[0];e?(v=Math.max(Math.floor((d-u*e)/e),0),w=Math.min(Math.ceil((d+c+u*e)/e),a.records.length)):(v=0,w=a.records.length),v=v&&v%2?v+1:v;var h=v-s>0||w-t>0;if(v!==s||w!==t){var i;if(f||(i=document.createElement("tr"),i.className="placeholderTop",i.style.height="0px",n[0].appendChild(i),f=b.find(".placeholderTop")[0]),g||(i=document.createElement("tr"),i.className="placeholderBot",i.style.height="0px",n[0].appendChild(i),g=b.find(".placeholderBot")[0]),!a.layout.length&&a.records.length)for(var j=Math.min(a.records.length,a.resultsPerPage),k=0;j>k;k++)C(k,a.records,"end");else if(h){for(var k=0;v>k;k++)D(k);f.style.height=v*e+"px";for(var l=b[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr"),m=l.length>2,o=m?parseInt(l[l.length-2].className.substr(7),10):v,p=0,k=o+1;w>k;k++)C(k,a.records,"end"),p++;var q=m?$(g).height()-p*e:(a.records.length-w)*e;q=q>0?q:0,g.style.height=q+"px"}else{for(var p=0,k=w+1;k<a.records.length;k++)D(k),p++;var r=a.records.length-(w+1);r=r>=0?r:0,g.style.height=r*e+"px";for(var l=b[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr"),m=l.length>2,x=m?parseInt(l[1].className.substr(7),10):w,p=0,k=x-1;k>=v;k--)C(k,a.records,"begin"),p++;var q=m?$(f).height()-p*e:v*e;q=q>0?q:0,f.style.height=q+"px"}s=v,t=w}};a.$watch("records",function(b,c){b!==c&&(E(),a.computeLayout())});var F=a.$watch("context.dataset",function(b){if(b&&b.datasetid){if(F(),a.displayedFieldsArray=a.displayedFields?a.displayedFields.split(",").map(function(a){return a.trim()}):a.context.dataset.extra_metas&&a.context.dataset.extra_metas.visualization&&angular.isArray(a.context.dataset.extra_metas.visualization.table_fields)&&a.context.dataset.extra_metas.visualization.table_fields.length>0?a.context.dataset.extra_metas.visualization.table_fields:null,!a.tableContext.tablesort&&a.context.dataset.extra_metas&&a.context.dataset.extra_metas.visualization&&a.context.dataset.extra_metas.visualization.table_default_sort_field){var c=a.context.dataset.extra_metas.visualization.table_default_sort_field;"-"===a.context.dataset.extra_metas.visualization.table_default_sort_direction&&(c="-"+c),a.tableContext.tablesort=c}a.staticSearchOptions={rows:a.resultsPerPage},g.log("table -> dataset watch -> refresh records");var d=h("fieldsForVisualization")(a.context.dataset.fields,"table");l=h("fieldsFilter")(d,a.displayedFieldsArray),A(!0)}},!0);a.$watch("[context.parameters, tableContext.tablesort]",function(c,d){c!==d&&(g.log("table -> searchOptions watch -> refresh records"),a.layout=[],a.working=!0,q=b.find(".records-body")[0].scrollLeft,r=!0,n.empty(),A(!0))},!0);var G=function(){b.find(".records-body").scrollLeft(0),m.css({left:"auto"}),o=b.find(".records-header").offset().left};$(window).on("resize",function(){c(function(){G(),a.layout=[],a.computeLayout()},0)});var H=0;b.find(".records-body").on("scroll",function(){if(this.scrollLeft!==p)m.offset({left:o-this.scrollLeft}),p=this.scrollLeft;else{r=!1;var a=Math.max(Math.floor(b.find(".records-body")[0].scrollTop/n.find("tr").eq(1).height()),0);if(Math.abs(a-H)<u&&a>v)return;H=a,E()}});var I=function(b,c){for(var d="",e=0;e<a.layout.length;e++){var f=e+1,g=c?"max-width: none; ":"";d+="#"+b+" .records-header tr th:nth-child("+f+") > div, #"+b+" .records-body tr td:nth-child("+f+") > div { width: "+a.layout[e]+"px; "+g+"} "}return d};a.computeLayout=function(){var d=b.find(".records-body tbody tr"),e=22;if(!a.layout.length&&a.records.length){if(b.attr("id")||b.attr("id",y),$(".embedded").length){var f=$(window).height()-b.offset().top;b.height(f)}else var f=b.height();b.find(".records-body").height(f-25);var g=n.find("tr").eq(1).height(),h=(d.length-2)*g,i=document.getElementById(z);i&&i.parentNode&&i.parentNode.removeChild(i),b.find(".records-header thead").hide(),b.find(".records-body thead").show();var j=0;angular.forEach(b.find(".records-body thead th > div"),function(b,c){a.layout[c]=$(b).width()+6,j+=a.layout[c]}),a.layout[0]=30;var k=b.find(".records-body table").width(),l=j+e*a.layout.length<b.width();if(l){for(var o=Math.floor(k/a.layout.length),p=k-o*a.layout.length,s=1;s<a.layout.length;s++)a.layout[s]=o-e;a.layout[a.layout.length-1]+=p,b.find(".records-header table").width(h>500?k:"")}var t=document.createElement("style"),u=I(y,l);t.id=z,t.type="text/css",t.styleSheet?t.styleSheet.cssText=u:t.appendChild(document.createTextNode(u)),b[0].appendChild(t),b.find(".records-body thead").hide(),b.find(".records-header thead").show(),r||c(function(){G()},0)}r&&(q||m.css({left:"auto"}),b.find(".records-body")[0].scrollLeft=q),a.layout.length&&(a.working=!1)}}]}}])}(),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsTagCloud",["ODSAPI",function(a){function b(a){var b=Math.floor(a.length/2);return a.length%2?a[b].count:(a[b-1].count+a[b].count)/2}function c(a,b){var c=$.grep(a,function(a){return a.count>=b}),d=$.grep(a,function(a){return a.count<=b}),e=[{count:c.length,min:c[c.length-1].count,max:c[0].count},{count:d.length,min:d[d.length-1].count,max:d[0].count}];return e[0].delta=e[0].max-e[0].min,e[1].delta=e[1].max-e[1].min,e}function d(a,b,c){var d,e=(a.count>=b?c[0].delta:c[1].delta)/2;return d=a.count>=2*e?1:a.count>=e&&a.count<2*e?2:3,d=a.count>=b?d:d+3,a={count:a.count,name:a.name,opacity:((7-d+4)/10+.05).toFixed(2),size:((7-d)/3).toFixed(1),weight:d},a.size=6!==d?a.size:parseFloat(a.size)+.3,a}function e(a){for(var b=a.length-1;b>0;b--){var c=Math.floor(Math.random()*(b+1)),d=a[b];a[b]=a[c],a[c]=d}return a}return{restrict:"E",replace:!0,template:'<div class="odswidget odswidget-tag-cloud"><ul><li class="no-data" ng-hide="tags" translate>No data available yet</li><li ng-repeat="tag in tags" class="tag tag{{ tag.weight }}" style="font-size: {{ tag.size }}em; opacity: {{ tag.opacity }}"><a ng-href="{{ context.domainUrl }}{{url }}/?refine.{{ facetName }}={{ tag.name }}">{{ tag.name }}</a></li></ul></div>',scope:{context:"=",facetName:"@",max:"@?"},controller:function(f){var g=function(){var g;g="catalog"===f.context.type?a.datasets.search(f.context,{rows:0,facet:f.facetName}):a.records.search(f.context,{rows:0,facet:f.facetName}),g.success(function(a){if(a.facet_groups){f.tags=a.facet_groups[0].facets,f.max&&(f.tags=f.tags.slice(0,f.max));for(var g=b(f.tags),h=0;h<f.tags.length;h++)f.tags[h]=d(f.tags[h],g,c(f.tags,g),f.context.domainUrl);f.tags=e(f.tags)}})};f.$watch("context",function(){("catalog"===f.context.type||"dataset"===f.context.type&&f.context.dataset)&&(f.url="catalog"===f.context.type?"/explore":"/explore/dataset/"+f.context.dataset.datasetid,g())},!0)}}}])}(),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsTextSearch",function(){return{restrict:"E",replace:!0,template:'<div class="odswidget odswidget-text-search"><form ng-submit="applySearch()"><input class="searchbox" name="q" type="text" ng-model="searchExpression" placeholder="{{placeholder}}"><button ng-bind="buttonText"></button></form></div>',scope:{placeholder:"@?",button:"@?",context:"="},controller:["$scope","translate",function(a,b){a.buttonText=a.button||b("Search"),a.applySearch=function(){a.context.parameters.q=a.searchExpression}}]}})}(),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsThemeBoxes",function(){return{restrict:"E",replace:!1,template:'<div class="odswidget odswidget-theme-boxes"><ods-facet-enumerator context="context" facet-name="theme"><a ng-href="{{context.domainUrl}}/explore/?refine.theme={{item.path}}" target="_self" ods-tooltip="{{item.name}} ({{item.count}} jeux de donnes)" ods-tooltip-direction="bottom" style="display: block;"><ods-theme-picto theme="{{item.name}}"></ods-theme-picto></a></div></ods-facet-enumerator></div>',scope:{context:"="}}})}(),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsThemePicto",["ODSWidgetsConfig","$http",function(a,b){var c={};return{restrict:"E",replace:!0,scope:{theme:"@"},template:'<div class="odswidget odswidget-theme-picto theme-{{getTheme()|themeSlug}}"></div>',link:function(d,e){var f=null,g=!1;a.themes[d.theme]?f=a.themes[d.theme]:(f=a.themes["default"],g=!0),d.getTheme=function(){return g?"default":d.theme};var h=function(a){var b=angular.element(a);f.color?b.css("fill",f.color):e.addClass("colorless"),e.append(b)};if(f){var i=f.img;if(-1===i.indexOf(".svg"))e.append(angular.element('<img src="'+i+'"/>'));else if(c[d.theme])c[d.theme].code?h(c[d.theme].code):c[d.theme].promise.success(function(a){h(a)});else{var j=b.get(i);c[d.theme]={promise:j},j.success(function(a){c[d.theme].code=a,h(a)})}}else;}}}])}(),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsTimescale",function(){return{restrict:"E",replace:!0,scope:{context:"=",timeField:"@"},template:'<div class="odswidget odswidget-timescale"><ul><li ng-class="{\'active\': scale == \'everything\' || !scale}"><a href="#" ng-click="selectScale(\'everything\'); $event.preventDefault();" translate>Everything</a></li><li ng-class="{\'active\': scale == \'year\'}"><a href="#" ng-click="selectScale(\'year\'); $event.preventDefault();" translate>Last 12 months</a></li><li ng-class="{\'active\': scale == \'month\'}"><a href="#" ng-click="selectScale(\'month\'); $event.preventDefault();" translate>Last 4 weeks</a></li><li ng-class="{\'active\': scale == \'week\'}"><a href="#" ng-click="selectScale(\'week\'); $event.preventDefault();" translate>Last 7 days</a></li><li ng-class="{\'active\': scale == \'day\'}"><a href="#" ng-click="selectScale(\'day\'); $event.preventDefault();" translate>Last 24 hours</a></li></ul></div>',controller:["$scope",function(a){var b={};if(angular.isUndefined(a.timeField))var c=a.$watch("context",function(d){d&&(angular.isArray(a.context)?angular.forEach(a.context,function(a){b[a.name]={context:a}}):b[a.context.name]={context:a.context},angular.forEach(b,function(b){var c=a.$watch(function(){return b.context.dataset},function(a){if(a){var d=a.fields.filter(function(a){return"date"===a.type||"datetime"===a.type});d.length>1&&console.log('Warning: the dataset "'+a.datasetid+'" has more than one date or datetime field, the first date or datetime field will be used. You can specify the field to use using the "time-field" parameter.'),0===d.length&&console.log('Error: the dataset "'+a.datasetid+"\" doesn't have any date or datetime field, which is required for the Timescale widget."),b.timeField=d[0].name,c()}})}),c())});else var d=a.$watch("context",function(c){c&&(angular.isArray(a.context)?angular.forEach(a.context,function(c){b[c.name]={context:c,timeField:a.timeField}}):b[a.context.name]={context:a.context,timeField:a.timeField},d())});a.selectScale=function(c){if(a.scale=c,"everything"===c)return void angular.forEach(b,function(a){delete a.context.parameters.q});var d=null,e=new Date;"day"===c?e.setDate(e.getDate()-1):"week"===c?e.setDate(e.getDate()-7):"month"===c?e.setMonth(e.getMonth()-1):"year"===c&&e.setFullYear(e.getFullYear()-1),d=e.toISOString(),angular.forEach(b,function(a){a.timeField&&(a.context.parameters.q=a.timeField+'>="'+d+'"')})}}]}})}(),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsTopPublishers",["ODSAPI",function(a){return{restrict:"E",replace:!0,template:'<div class="odswidget odswidget-top-publishers"><ul>   <li class="no-data" ng-hide="publishers" translate>No data available yet</li>   <li ng-repeat="publisher in publishers" ng-if="publishers">       <div class="dataset-details">           <div class="name"><a ng-href="{{ context.domainUrl }}/explore/?refine.publisher={{ publisher.path }}" target="_self">{{ publisher.name }}</a></div>           <div class="count"><i class="icon-table"></i> <translate>Used by</translate> {{ publisher.count }} '+"<ng-pluralize count=\"publisher.count\" translate=\"when\" when=\"{'0': 'dataset', '1': 'dataset', 'other': 'datasets'}\"></ng-pluralize></div>       </div>   </li></ul></div>",scope:{context:"="},controller:["$scope",function(b){var c=function(){a.datasets.facets(b.context,"publisher").success(function(a){b.publishers=a.facet_groups[0].facets.slice(0,5)})};b.$watch("context",function(){c()})}]}}])}(),function(){"use strict";var a=angular.module("ods-widgets");a.directive("odsTwitterTimeline",function(){return{restrict:"E",replace:!0,template:'<div class="odswidget"></div>',scope:{widgetId:"@"},link:function(a,b,c){var d='<a class="twitter-timeline" href="https://twitter.com/twitterapi" data-widget-id="'+c.widgetId+'">Tweets</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>';b.append(d)}}})}();